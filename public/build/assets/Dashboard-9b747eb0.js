var Ze=Object.defineProperty;var Je=(e,a,t)=>a in e?Ze(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t;var d=(e,a,t)=>(Je(e,typeof a!="symbol"?a+"":a,t),t);import{r as S,d as A,p as Ke,u as T,c as o,a as oe,I as q,m as Ce,V as le,b as pe,R as Qe,e as He,f as Xe,g as Ye,h as et,i as tt,j as nt,k as at,l as lt,n as it,o as Z,q as st,s as ot,t as rt,v as ut,w as ct,x as dt,y as mt,z as xe,A as ft,B as vt,C as ht,D as pt,E as p,F as yt,G as gt,H as _t,L as Ie,J as kt,K as M,M as wt,N as bt,O as b,P as I,Q as v,S as Ve,T as w,U as V,W as c,X as Ct,Y as Se,Z as G,_ as re,$ as F,a0 as $,a1 as $e,a2 as xt,a3 as ie,a4 as It,a5 as Ae,a6 as De,a7 as z,a8 as Vt,a9 as B,aa as x,ab as se,ac as St,ad as $t,ae as ue,af as Pe,ag as At,ah as Dt,ai as ye,aj as Pt,ak as Rt,al as Lt,am as Bt,an as jt,ao as Nt,ap as ge,aq as Et,ar as Tt,as as Mt,at as Ot,au as Wt,av as Ut,aw as qt,ax as Gt}from"./app-7cc66818.js";import{_ as O,a as Ft}from"./Default.vue_vue_type_script_setup_true_lang-adac53d9.js";import{u as j,i as zt,a as Re,T as Zt,b as Jt,c as Kt,O as Qt,d as Ht,e as Xt,r as _e}from"./Ticket-8c8fb5ab.js";import{P as U}from"./index.m-3c027150.js";function Yt(e,a){const t=S();return j(e,"dragstart",n=>{if(t.value=n.target,typeof a=="string"){const l=a;a=(i,s)=>{s==null||s.setData("text/plain",i.dataset[l]??"")}}a==null||a(t.value,n.dataTransfer)}),j(e,"dragend",()=>{t.value=null}),{element:t}}function Le(e,a,t=!0){const n=S(!1);let l=0;return zt&&(j(e,"dragenter",i=>{i.preventDefault(),l++,n.value=!0}),j(e,"dragover",i=>{i.preventDefault()}),j(e,"dragleave",i=>{i.preventDefault(),l--,l===0&&(n.value=!1)}),j(e,"drop",i=>{var s;if(i.preventDefault(),l=0,n.value=!1,a)if(t){const u=Array.from(((s=i.dataTransfer)==null?void 0:s.files)??[]);a(u.length===0?null:u)}else a(i.dataTransfer)})),{isOverDropZone:n}}const en=A({name:"VCardActions",setup(e,a){let{slots:t}=a;return Ke({VBtn:{variant:"text"}}),T(()=>{var n;return o("div",{class:"v-card-actions"},[(n=t.default)==null?void 0:n.call(t)])}),{}}}),tn=oe("v-card-subtitle"),nn=oe("v-card-title"),an=A({name:"VCardItem",props:{appendAvatar:String,appendIcon:q,prependAvatar:String,prependIcon:q,subtitle:String,title:String,...Ce()},setup(e,a){let{slots:t}=a;return T(()=>{var n,l,i,s,u;const r=!!(e.prependAvatar||e.prependIcon||t.prepend),m=!!(e.appendAvatar||e.appendIcon||t.append),h=!!(e.title||t.title),f=!!(e.subtitle||t.subtitle);return o("div",{class:"v-card-item"},[r&&o(le,{key:"prepend",defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar},VIcon:{density:e.density,icon:e.prependIcon}}},{default:()=>[o("div",{class:"v-card-item__prepend"},[((n=t.prepend)==null?void 0:n.call(t))??o(pe,null,null)])]}),o("div",{class:"v-card-item__content"},[h&&o(nn,{key:"title"},{default:()=>[((l=t.title)==null?void 0:l.call(t))??e.title]}),f&&o(tn,{key:"subtitle"},{default:()=>[((i=t.subtitle)==null?void 0:i.call(t))??e.subtitle]}),(s=t.default)==null?void 0:s.call(t)]),m&&o(le,{key:"append",defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar},VIcon:{density:e.density,icon:e.appendIcon}}},{default:()=>[o("div",{class:"v-card-item__append"},[((u=t.append)==null?void 0:u.call(t))??o(pe,null,null)])]})])}),{}}}),Be=oe("v-card-text"),ln=A({name:"VCard",directives:{Ripple:Qe},props:{appendAvatar:String,appendIcon:q,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:q,ripple:{type:Boolean,default:!0},subtitle:String,text:String,title:String,...He(),...Xe(),...Ce(),...Ye(),...et(),...tt(),...nt(),...at(),...lt(),...it(),...Z(),...st({variant:"elevated"})},setup(e,a){let{attrs:t,slots:n}=a;const{themeClasses:l}=ot(e),{borderClasses:i}=rt(e),{colorClasses:s,colorStyles:u,variantClasses:r}=ut(e),{densityClasses:m}=ct(e),{dimensionStyles:h}=dt(e),{elevationClasses:f}=mt(e),{loaderClasses:_}=xe(e),{locationStyles:y}=ft(e),{positionClasses:k}=vt(e),{roundedClasses:J}=ht(e),D=pt(e,t),he=p(()=>e.link!==!1&&D.isLink.value),P=p(()=>!e.disabled&&e.link!==!1&&(e.link||D.isClickable.value));return T(()=>{var K,N,W;const R=he.value?"a":e.tag,L=!!(n.title||e.title),Q=!!(n.subtitle||e.subtitle),H=L||Q,X=!!(n.append||e.appendAvatar||e.appendIcon),Y=!!(n.prepend||e.prependAvatar||e.prependIcon),E=!!(n.image||e.image),ee=H||Y||X,te=!!(n.text||e.text);return yt(o(R,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":P.value},l.value,i.value,s.value,m.value,f.value,_.value,k.value,J.value,r.value],style:[u.value,h.value,y.value],href:D.href.value,onClick:P.value&&D.navigate,tabindex:e.disabled?-1:void 0},{default:()=>[E&&o(le,{key:"image",defaults:{VImg:{cover:!0,src:e.image}}},{default:()=>[o("div",{class:"v-card__image"},[((K=n.image)==null?void 0:K.call(n))??o(_t,null,null)])]}),o(Ie,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:n.loader}),ee&&o(an,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:n.item,prepend:n.prepend,title:n.title,subtitle:n.subtitle,append:n.append}),te&&o(Be,{key:"text"},{default:()=>[((N=n.text)==null?void 0:N.call(n))??e.text]}),(W=n.default)==null?void 0:W.call(n),n.actions&&o(en,null,{default:n.actions}),kt(P.value,"v-card")]}),[[gt("ripple"),P.value&&e.ripple]])}),{}}}),sn={class:"d-inline-block"},on={class:"text-white"},rn={class:"text-left"},un=M({__name:"Ticket",props:{ticket:null},setup(e){const a=e;wt(r=>({"6dde3a3a":c(u).delay,c699af98:c(u).duration}));const t=Re(),n=p(()=>{var r;return(r=bt().props)==null?void 0:r[`${t.value}Threshold`]}),l=p(()=>a.ticket[t.value]),i=p(()=>l.value<1e5?l.value:l.value.toExponential(1)),s=p(()=>l.value>n.value),u=p(()=>({delay:-l.value+"s",duration:n.value+"s"}));return(r,m)=>(b(),I("div",sn,[o($,{size:"small",class:F(["ticket",{overflow:c(s)}]),flat:"",width:"100"},{default:v(()=>[o(Ve,{color:"white",icon:"mdi-airplane",start:""}),w("span",on,V(c(i)),1),o(Ct,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:v(()=>[o(ln,{width:"400",title:"aaa",subtitle:"bbb"},{default:v(()=>[o(Be,null,{default:v(()=>[o(Se,null,{default:v(()=>[(b(!0),I(G,null,re(e.ticket.meta,(h,f)=>(b(),I("tr",{key:f},[w("th",rn,V(f),1),w("td",null,V(h),1)]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["class"])]))}});const cn=O(un,[["__scopeId","data-v-d456c3cb"]]);class dn extends xt{increment(a){return this.incrementOrDecrement(a,!0)}decrement(a){return this.incrementOrDecrement(a,!1)}incrementOrDecrement(a,t){const n=this.get(!1);if(n.length===0)return[];const l=n.map(i=>{const s=i.$getAttributes();for(const r in a)Object.prototype.hasOwnProperty.call(s,r)&&typeof s[r]=="number"&&(t?s[r]+=a[r]:s[r]-=a[r]);const u=this.hydrate(s,{action:"update",operation:"set"});return i.$self().updating(i,a)===!1?i:(u.$self().updated(u),u)});return this.commit("update",this.compile(l)),l}}class mn extends $e{query(){return new dn(this.database,this.getModel(),this.queryCache,this.hydratedDataCache,this.pinia)}}class je extends mn{constructor(){super(...arguments);d(this,"use",Zt);d(this,"create",({uuid:t,categoryUuid:n})=>{this.save({uuid:t,category_uuid:n,created_at:new Date().toISOString()})});d(this,"close",({uuid:t})=>{this.destroy(t)});d(this,"bind",({uuid:t,operatorUuid:n})=>{this.where("uuid",t).update({handler_uuid:n})});d(this,"unbind",({uuid:t})=>{this.where("uuid",t).update({handler_uuid:null})});d(this,"changeCategory",({uuid:t,categoryUuid:n})=>{this.where("uuid",t).update({category_uuid:n})});d(this,"setMetaValue",({uuid:t,key:n,value:l})=>{var s;const i=((s=this.find(t))==null?void 0:s.meta)??{};i[n]=l,this.where("uuid",t).update({meta:i})});d(this,"incrementInitialWeight",({uuid:t,weightPoints:n})=>{this.query().where("uuid",t).increment({initial_weight:n})});d(this,"decrementInitialWeight",({uuid:t,weightPoints:n})=>{this.query().where("uuid",t).decrement({initial_weight:n})});d(this,"incrementWeightIncrement",({uuid:t,weightPoints:n})=>{this.query().where("uuid",t).increment({weight_increment:n})});d(this,"decrementWeightIncrement",({uuid:t,weightPoints:n})=>{this.query().where("uuid",t).decrement({weight_increment:n})});d(this,"incrementComplexity",({uuid:t,complexityPoints:n})=>{this.query().where("uuid",t).increment({complexity:n})});d(this,"decrementComplexity",({uuid:t,complexityPoints:n})=>{this.query().where("uuid",t).decrement({complexity:n})});d(this,"incrementDelay",({uuid:t,delaySeconds:n})=>{this.query().where("uuid",t).increment({delay:n})});d(this,"decrementDelay",({uuid:t,delaySeconds:n})=>{this.query().where("uuid",t).decrement({delay:n})})}unbound(){return this.where("handler_uuid",null)}bound(t){return this.where("handler_uuid",t)}}const fn=M({__name:"TicketPool",props:{tickets:null},setup(e){const a=S(null);Yt(a,"uuid");const{lock:t,unlock:n,element:l,triggerElement:i}=Jt(a),{x:s}=Kt({type:"movement"}),u=p(()=>ie(je));It([l,s],([m,h])=>{if(!m||!i.value)return;const f=i.value.dataset.uuid;h<0?u.value.incrementInitialWeight({uuid:f,weightPoints:-h*10}):h>0&&u.value.decrementInitialWeight({uuid:f,weightPoints:h*10})});const r=S(!1);return Ae(()=>{setTimeout(()=>r.value=!0,500)}),(m,h)=>(b(),I("div",{ref_key:"ticketPool",ref:a,onMouseup:h[0]||(h[0]=(...f)=>c(n)&&c(n)(...f))},[o(De,{name:"ticket-pool",css:r.value},{default:v(()=>[(b(!0),I(G,null,re(e.tickets,f=>(b(),z(cn,{key:f.uuid,"data-uuid":f.uuid,ticket:f,draggable:"true",class:"mr-1 mb-1",onMousedown:Vt(c(t),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css"])],544))}});const vn=O(fn,[["__scopeId","data-v-17e8baeb"]]);function ce(){async function e(l,i){return await window.axios.patch(U("ticket-allocator.api.ready",l),{ready:i})}async function a(l,i){return await window.axios.patch(U("ticket-allocator.api.weight",l),{weight_points:i})}async function t(l,i){return await window.axios.patch(U("ticket-allocator.api.handler",l),{operator_uuid:i??null})}async function n(l){return await window.axios.delete(U("ticket-allocator.api.close",l))}return{ready:e,weight:a,handler:t,close:n}}const hn={class:"status"},pn={class:"name font-weight-bold"},yn={class:"load text-center"},gn={class:"complexity text-center"},_n={class:"more text-center"},kn=M({__name:"TicketRow",props:{tickets:null},setup(e){const a=e;let t=S(!1);const n=p(()=>a.tickets.reduce((r,{complexity:m})=>r+m,0)),l=p(()=>t.value?"mdi-chevron-down":"mdi-chevron-up"),i=ce(),s=S(null),{isOverDropZone:u}=Le(s,async r=>{var f;const m=r==null?void 0:r.getData("text/plain");if(!m)throw new Error("Ticket UUID undefined.");const h=(f=s.value)==null?void 0:f.dataset.uuid;return await i.handler(m,h)},!1);return(r,m)=>(b(),I("tr",{ref_key:"ticketRow",ref:s,class:F(["ticket-row",{dragover:c(u)}])},[w("td",hn,[B(r.$slots,"status",{},void 0,!0)]),w("td",pn,[B(r.$slots,"name",{},void 0,!0)]),w("td",yn,[B(r.$slots,"load",{},()=>[x(V(e.tickets.length),1)],!0),x("/"),B(r.$slots,"load-max",{},()=>[x("∞")],!0)]),w("td",gn,[B(r.$slots,"complexity",{},()=>[x(V(c(n)),1)],!0),x("/"),B(r.$slots,"complexity-max",{},()=>[x("∞")],!0)]),w("td",{class:F(["tickets pt-1",{collapsed:c(t)}])},[o(vn,{tickets:e.tickets},null,8,["tickets"])],2),w("td",_n,[o($,{size:"x-small",variant:"tonal",icon:c(l),onClick:m[0]||(m[0]=h=>se(t)?t.value=!c(t):t=!c(t))},null,8,["icon"])])],2))}});const Ne=O(kn,[["__scopeId","data-v-f80d4517"]]),wn=M({__name:"OperatorRow",props:{operator:null},setup(e){const a=e,t=p(()=>{var i,s;return{online:a.operator.online,ready:a.operator.ready,busy:!!((i=a.operator.tickets)!=null&&i.length),full:a.operator.ticket_limit!==null&&((s=a.operator.tickets)==null?void 0:s.length)>=a.operator.ticket_limit}}),n=ce(),l=async()=>await n.ready(a.operator.uuid,!a.operator.ready);return(i,s)=>(b(),z(Ne,{tickets:e.operator.tickets,"data-uuid":e.operator.uuid,class:F(["operator",c(t)])},{status:v(()=>[o(Ve,{icon:"mdi-account",onClick:l})]),"load-max":v(()=>[x(V(e.operator.ticket_limit??"∞"),1)]),"complexity-max":v(()=>[x(V(e.operator.complexity_limit??"∞"),1)]),name:v(()=>[x(V(e.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}});const bn=O(wn,[["__scopeId","data-v-95e8bd34"]]),Cn="ticket-allocator";var C=(e=>(e.Commented=".operator.commented",e.ComplexityLimitAdjusted=".operator.complexity-limit-adjusted",e.Enrolled=".operator.enrolled",e.JoinedTeam=".operator.joined-team",e.LeftTeam=".operator.left-team",e.NameChanged=".operator.name-changed",e.NotReady=".operator.not-ready",e.Offline=".operator.offline",e.Online=".operator.online",e.Ready=".operator.ready",e.Resigned=".operator.resigned",e.TicketCategoryAttached=".operator.ticket-category-attached",e.TicketCategoryDetached=".operator.ticket-category-detached",e.TicketLimitAdjusted=".operator.ticket-limit-adjusted",e))(C||{}),g=(e=>(e.Bound=".ticket.bound",e.CategoryChanged=".ticket.category-changed",e.MetaValueSet=".ticket.meta-value-set",e.Closed=".ticket.closed",e.ComplexityDecremented=".ticket.complexity-decremented",e.ComplexityIncremented=".ticket.complexity-incremented",e.Created=".ticket.created",e.DelayDecremented=".ticket.delay-decremented",e.DelayIncremented=".ticket.delay-incremented",e.InitialWeightDecremented=".ticket.initial-weight-decremented",e.InitialWeightIncremented=".ticket.initial-weight-incremented",e.Tagged=".ticket.tagged",e.Unbound=".ticket.unbound",e.WeightIncrementDecremented=".ticket.weight-increment-decremented",e.WeightIncrementIncremented=".ticket.weight-increment-incremented",e))(g||{});function xn(e,a){return e.reduce((t,n)=>(typeof n[a]=="number"&&(t+=n[a]),t),0)}function de(e,a){return e.map(t=>St(t,a)).filter(t=>t)}function In(e,a){const t=de(e,a).filter(n=>typeof n=="number");return t.length===0?0:Math.max(...t)}function Vn(e,a){const t=de(e,a).filter(n=>typeof n=="number");return t.length===0?0:Math.min(...t)}function Sn(e){return e.map(a=>a[a.$getLocalKey()])}function $n(e,a){const t={},n=Array.isArray(a)?a:[a];return e.forEach(l=>{const i=n.length===1?l[n[0]]:`[${n.map(s=>l[s]).toString()}]`;t[i]=(t[i]||[]).concat(l)}),t}function An(e,a,t){const n=[],l=[];return typeof a=="function"&&l.push(a)&&n.push("asc"),Array.isArray(a)&&a.forEach(i=>l.push(i[0])&&n.push(i[1])),l.length===0&&l.push(a),$t(e,l,n,t)}function Dn(e){return{sum:a=>xn(e,a),min:a=>Vn(e,a),max:a=>In(e,a),pluck:a=>de(e,a),groupBy:a=>$n(e,a),sortBy:(a,t="SORT_REGULAR")=>An(e,a,t),keys:()=>Sn(e)}}class Pn extends $e{constructor(){super(...arguments);d(this,"use",Qt);d(this,"enroll",({uuid:t})=>{this.save({uuid:t})});d(this,"resign",({uuid:t})=>{this.destroy(t)});d(this,"changeName",({uuid:t,name:n})=>{this.where("uuid",t).update({name:n})});d(this,"setOnline",({uuid:t})=>{this.where("uuid",t).update({online:!0})});d(this,"setOffline",({uuid:t})=>{this.where("uuid",t).update({online:!1})});d(this,"setReady",({uuid:t})=>{this.where("uuid",t).update({ready:!0})});d(this,"setNotReady",({uuid:t})=>{this.where("uuid",t).update({ready:!1})});d(this,"adjustTicketLimit",({uuid:t,ticketLimit:n})=>{this.where("uuid",t).update({ticket_limit:n})});d(this,"adjustComplexityLimit",({uuid:t,complexityLimit:n})=>{this.where("uuid",t).update({complexity_limit:n})})}}const Rn=A({name:"VContainer",props:{fluid:{type:Boolean,default:!1},...Z()},setup(e,a){let{slots:t}=a;return T(()=>o(e.tag,{class:["v-container",{"v-container--fluid":e.fluid}]},t)),{}}}),me=["sm","md","lg","xl","xxl"],Ee=(()=>me.reduce((e,a)=>(e[a]={type:[Boolean,String,Number],default:!1},e),{}))(),Te=(()=>me.reduce((e,a)=>(e["offset"+ue(a)]={type:[String,Number],default:null},e),{}))(),Me=(()=>me.reduce((e,a)=>(e["order"+ue(a)]={type:[String,Number],default:null},e),{}))(),ke={col:Object.keys(Ee),offset:Object.keys(Te),order:Object.keys(Me)};function Ln(e,a,t){let n=e;if(!(t==null||t===!1)){if(a){const l=a.replace(e,"");n+=`-${l}`}return e==="col"&&(n="v-"+n),e==="col"&&(t===""||t===!0)||(n+=`-${t}`),n.toLowerCase()}}const Bn=["auto","start","end","center","baseline","stretch"],ae=A({name:"VCol",props:{cols:{type:[Boolean,String,Number],default:!1},...Ee,offset:{type:[String,Number],default:null},...Te,order:{type:[String,Number],default:null},...Me,alignSelf:{type:String,default:null,validator:e=>Bn.includes(e)},...Z()},setup(e,a){let{slots:t}=a;const n=p(()=>{const l=[];let i;for(i in ke)ke[i].forEach(u=>{const r=e[u],m=Ln(i,u,r);m&&l.push(m)});const s=l.some(u=>u.startsWith("v-col-"));return l.push({"v-col":!s||!e.cols,[`v-col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),l});return()=>{var l;return Pe(e.tag,{class:n.value},(l=t.default)==null?void 0:l.call(t))}}}),jn=["sm","md","lg","xl","xxl"],fe=["start","end","center"],Oe=["space-between","space-around","space-evenly"];function ve(e,a){return jn.reduce((t,n)=>(t[e+ue(n)]=a(),t),{})}const Nn=[...fe,"baseline","stretch"],We=e=>Nn.includes(e),Ue=ve("align",()=>({type:String,default:null,validator:We})),En=[...fe,...Oe],qe=e=>En.includes(e),Ge=ve("justify",()=>({type:String,default:null,validator:qe})),Tn=[...fe,...Oe,"stretch"],Fe=e=>Tn.includes(e),ze=ve("alignContent",()=>({type:String,default:null,validator:Fe})),we={align:Object.keys(Ue),justify:Object.keys(Ge),alignContent:Object.keys(ze)},Mn={align:"align",justify:"justify",alignContent:"align-content"};function On(e,a,t){let n=Mn[e];if(t!=null){if(a){const l=a.replace(e,"");n+=`-${l}`}return n+=`-${t}`,n.toLowerCase()}}const Wn=A({name:"VRow",props:{dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:We},...Ue,justify:{type:String,default:null,validator:qe},...Ge,alignContent:{type:String,default:null,validator:Fe},...ze,...Z()},setup(e,a){let{slots:t}=a;const n=p(()=>{const l=[];let i;for(i in we)we[i].forEach(s=>{const u=e[s],r=On(i,s,u);r&&l.push(r)});return l.push({"v-row--no-gutters":e.noGutters,"v-row--dense":e.dense,[`align-${e.align}`]:e.align,[`justify-${e.justify}`]:e.justify,[`align-content-${e.alignContent}`]:e.alignContent}),l});return()=>{var l;return Pe(e.tag,{class:["v-row",n.value]},(l=t.default)==null?void 0:l.call(t))}}});const be=A({name:"VSwitch",inheritAttrs:!1,props:{indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...At(),...Dt()},emits:{"update:focused":e=>!0,"update:modelValue":()=>!0,"update:indeterminate":e=>!0},setup(e,a){let{attrs:t,slots:n}=a;const l=ye(e,"indeterminate"),i=ye(e,"modelValue"),{loaderClasses:s}=xe(e),{isFocused:u,focus:r,blur:m}=Pt(e),h=p(()=>typeof e.loading=="string"&&e.loading!==""?e.loading:e.color),f=Rt(),_=p(()=>e.id||`switch-${f}`);function y(){l.value&&(l.value=!1)}return T(()=>{const[k,J]=Lt(t),[D,he]=Bt(e),[P,K]=jt(e),N=S();function W(){var R,L;(R=N.value)==null||(L=R.input)==null||L.click()}return o(Tt,ge({class:["v-switch",{"v-switch--inset":e.inset},{"v-switch--indeterminate":l.value},s.value]},k,D,{id:_.value,focused:u.value}),{...n,default:R=>{let{id:L,messagesId:Q,isDisabled:H,isReadonly:X,isValid:Y}=R;return o(Nt,ge({ref:N},P,{modelValue:i.value,"onUpdate:modelValue":[E=>i.value=E,y],id:L.value,"aria-describedby":Q.value,type:"checkbox","aria-checked":l.value?"mixed":void 0,disabled:H.value,readonly:X.value,onFocus:r,onBlur:m},J),{...n,default:()=>o("div",{class:"v-switch__track",onClick:W},null),input:E=>{let{textColorClasses:ee,textColorStyles:te}=E;return o("div",{class:["v-switch__thumb",ee.value],style:te.value},[e.loading&&o(Ie,{name:"v-switch",active:!0,color:Y.value===!1?void 0:h.value},{default:ne=>n.loader?n.loader(ne):o(Et,{active:ne.isActive,color:ne.color,indeterminate:!0,size:"16",width:"2"},null)})])}})}})}),{}}}),Un=e=>(qt("data-v-0eeaff63"),e=e(),Gt(),e),qn=Un(()=>w("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Dashboard",-1)),Gn={class:"align-text-top"},Fn=M({__name:"Dashboard",props:{operators:null,tickets:null},setup(e){const a=e,t=Ht(),n=Re(),l=Xt(),i=p(()=>ie(Pn)),s=p(()=>ie(je)),u=_e(p(()=>Dn(i.value.with("tickets",_=>{_.orderBy(n.value,"desc")}).get()).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),750),r=_e(p(()=>s.value.unbound().orderBy(n.value,"desc").get()),750),m=ce(),h=S(null),{isOverDropZone:f}=Le(h,async _=>{const y=_==null?void 0:_.getData("text/plain");if(!y)throw new Error("Ticket UUID undefined.");return await m.close(y)},!1);return Ae(()=>{i.value.fresh(a.operators),s.value.fresh(a.tickets),window.ticketAllocatorChannel=window.Echo.channel(Cn),window.ticketAllocatorChannel.listenToAll((_,y)=>{console.log(_,y)}),window.ticketAllocatorChannel.listen(C.Enrolled,i.value.enroll).listen(C.Resigned,i.value.resign).listen(C.NameChanged,i.value.changeName).listen(C.Online,i.value.setOnline).listen(C.Offline,i.value.setOffline).listen(C.Ready,i.value.setReady).listen(C.NotReady,i.value.setNotReady).listen(C.TicketLimitAdjusted,i.value.adjustTicketLimit).listen(C.ComplexityLimitAdjusted,i.value.adjustComplexityLimit).listen(g.Created,s.value.create).listen(g.Closed,s.value.close).listen(g.Bound,s.value.bind).listen(g.Unbound,s.value.unbind).listen(g.CategoryChanged,s.value.changeCategory).listen(g.MetaValueSet,s.value.setMetaValue).listen(g.InitialWeightIncremented,s.value.incrementInitialWeight).listen(g.InitialWeightDecremented,s.value.decrementInitialWeight).listen(g.WeightIncrementIncremented,s.value.incrementWeightIncrement).listen(g.WeightIncrementDecremented,s.value.decrementWeightIncrement).listen(g.ComplexityIncremented,s.value.incrementComplexity).listen(g.ComplexityDecremented,s.value.decrementComplexity).listen(g.DelayIncremented,s.value.incrementDelay).listen(g.DelayDecremented,s.value.decrementDelay)}),(_,y)=>(b(),I(G,null,[o(c(Mt),{title:"Dashboard"}),o(Ft,null,{header:v(()=>[qn]),default:v(()=>[w("div",null,[o(Rn,{fluid:""},{default:v(()=>[o(Wn,null,{default:v(()=>[o(ae,null,{default:v(()=>[o(Ot,{modelValue:c(t).all,"onUpdate:modelValue":y[0]||(y[0]=k=>c(t).all=k),variant:"plain",multiple:""},{default:v(()=>[o($,{value:"hide-empty",icon:c(t).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),o($,{value:"alt-info",icon:c(t).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),o($,{value:"unlocked",icon:c(t).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:c(t).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),c(t).unlocked?(b(),z(Wt,{key:0,variant:"plain"},{default:v(()=>[o($,{ref_key:"closeTicket",ref:h,icon:c(f)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),o($,{icon:"mdi-refresh"})]),_:1})):Ut("",!0)]),_:1}),o(ae,{cols:"2"},{default:v(()=>[o(be,{modelValue:c(l),"onUpdate:modelValue":y[1]||(y[1]=k=>se(l)?l.value=k:null),"false-value":"asc","true-value":"desc","prepend-icon":"mdi-sort-ascending","append-icon":"mdi-sort-descending",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1}),o(ae,{cols:"2"},{default:v(()=>[o(be,{modelValue:c(n),"onUpdate:modelValue":y[2]||(y[2]=k=>se(n)?n.value=k:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),o(Se,{class:"ticket-monitor"},{default:v(()=>[w("tbody",Gn,[o(Ne,{tickets:c(r)},{name:v(()=>[x("Очередь заявок")]),_:1},8,["tickets"]),o(De,{name:"operator-pool"},{default:v(()=>[(b(!0),I(G,null,re(c(u),k=>(b(),z(bn,{key:k.uuid,operator:k},null,8,["operator"]))),128))]),_:1})])]),_:1})])]),_:1})],64))}});const Hn=O(Fn,[["__scopeId","data-v-0eeaff63"]]);export{Hn as default};
//# sourceMappingURL=Dashboard-9b747eb0.js.map
