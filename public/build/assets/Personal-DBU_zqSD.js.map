{"version":3,"file":"Personal-DBU_zqSD.js","sources":["../../../resources/js/pages/Personal.vue"],"sourcesContent":["<template>\n    <Head :title=\"$t('personal')\" />\n\n    <DefaultLayout>\n        <template #header>\n            <h2 class=\"font-semibold text-xl text-gray-800 leading-tight\">{{ $t(\"personal\") }}</h2>\n        </template>\n\n        <div>\n            <v-container fluid>\n                <v-row>\n                    <v-col>\n                        <v-btn-toggle v-model=\"options.all\" variant=\"plain\" multiple>\n                            <v-btn\n                                value=\"alt-info\"\n                                :icon=\"options.altInfo ? 'mdi-magnify-plus-outline' : 'mdi-magnify'\"\n                            />\n                        </v-btn-toggle>\n                    </v-col>\n                    <v-col cols=\"2\">\n                        <v-switch\n                            v-model=\"mode\"\n                            false-value=\"weight\"\n                            true-value=\"duration\"\n                            prepend-icon=\"mdi-weight\"\n                            append-icon=\"mdi-clock\"\n                            class=\"d-flex justify-end\"\n                        />\n                    </v-col>\n                </v-row>\n            </v-container>\n            <v-data-table density=\"compact\" class=\"personal-monitor\" :headers=\"headers\" :items=\"sortedTickets\" />\n            <!--<v-data-table density=\"compact\" class=\"personal-monitor\" :headers=\"headers\" :items=\"sortedTickets\">\n                <TransitionGroup name=\"ticket-pool\">\n                    <PersonalTicket v-for=\"ticket in sortedTickets\" :key=\"ticket.uuid\" :ticket=\"ticket\" />\n                </TransitionGroup>\n            </v-data-table>-->\n        </div>\n    </DefaultLayout>\n</template>\n\n<script setup lang=\"ts\">\nimport DefaultLayout from \"@/layouts/Default.vue\";\nimport PersonalTicket from \"@/components/PersonalTicket.vue\";\nimport { Head, router } from \"@inertiajs/vue3\";\nimport { computed, onMounted, onUnmounted } from \"vue\";\nimport { useI18n } from \"vue-i18n\";\nimport { usePusherChannel } from \"@/composables\";\nimport type { Operator, Ticket, TicketCategory } from \"@/types\";\nimport { useSharedOptions, useSharedDisplayMode } from \"@/shared\";\nimport * as Events from \"@/types/events.d\";\n\nimport { useRepo } from \"pinia-orm\";\nimport OperatorRepository from \"@/repositories/OperatorRepository\";\nimport TicketRepository from \"@/repositories/TicketRepository\";\nimport TicketCategoryRepository from \"@/models/TicketCategory\";\n\nconst props = defineProps<{\n    operator: Operator;\n    tickets: Ticket[];\n    ticketCategories: TicketCategory[];\n}>();\n\nconst options = useSharedOptions();\nconst mode = useSharedDisplayMode();\n\nconst operatorRepo = computed(() => useRepo(OperatorRepository));\nconst ticketRepo = computed(() => useRepo(TicketRepository));\nconst ticketCategoryRepo = computed(() => useRepo(TicketCategoryRepository));\nconst channel = usePusherChannel(Events.Channel);\n\nconst { t } = useI18n();\n\nconst headers = computed(() => [\n    { title: t(\"active\"), key: \"active\", sortable: false },\n    { title: t(\"name\"), key: \"name\" },\n    { title: t(\"description\"), key: \"description\" },\n    { title: t(\"actions\"), key: \"actions\", sortable: false },\n]);\n\nconst sortedTickets = computed(() =>\n    ticketRepo.value.bound(props.operator.uuid).with(\"category\").orderBy(mode.value, \"desc\").get(),\n);\n\nonMounted(() => {\n    channel\n        .listen(Events.Common.PropsInvalidated, () => router.reload())\n        .listen(Events.Ticket.Created, ticketRepo.value.create)\n        .listen(Events.Ticket.Closed, ticketRepo.value.close)\n        .listen(Events.Ticket.Bound, ticketRepo.value.bind)\n        .listen(Events.Ticket.Accepted, ticketRepo.value.accept)\n        .listen(Events.Ticket.Unbound, ticketRepo.value.unbind)\n        .listen(Events.Ticket.CategoryChanged, ticketRepo.value.changeCategory)\n        .listen(Events.Ticket.MetaValueSet, ticketRepo.value.setMetaValue)\n        .listen(Events.Ticket.MetaValuesMerged, ticketRepo.value.mergeMetaValues)\n        .listen(Events.Ticket.MetricsAdjusted, ticketRepo.value.adjustMetrics);\n});\n\nfunction refreshRepositories() {\n    operatorRepo.value.fresh(props.operator);\n    ticketRepo.value.fresh(props.tickets);\n    ticketCategoryRepo.value.fresh(props.ticketCategories);\n}\n\nconst removeNavigateEventListener = router.on(\"navigate\", refreshRepositories);\nconst removeSuccessEventListener = router.on(\"success\", refreshRepositories);\n\nonUnmounted(() => {\n    removeNavigateEventListener();\n    removeSuccessEventListener();\n});\n</script>\n\n<style scoped>\n.ticket-pool-move {\n    transition: all 0.5s ease;\n}\n</style>\n"],"names":["props","__props","options","useSharedOptions","mode","useSharedDisplayMode","operatorRepo","computed","useRepo","OperatorRepository","ticketRepo","TicketRepository","ticketCategoryRepo","TicketCategoryRepository","channel","usePusherChannel","Events.Channel","t","useI18n","headers","sortedTickets","onMounted","Events.Common","router","Events.Ticket","refreshRepositories","removeNavigateEventListener","removeSuccessEventListener","onUnmounted"],"mappings":"g4BAyDA,MAAMA,EAAQC,EAMRC,EAAUC,IACVC,EAAOC,IAEPC,EAAeC,EAAS,IAAMC,EAAQC,CAAkB,CAAC,EACzDC,EAAaH,EAAS,IAAMC,EAAQG,CAAgB,CAAC,EACrDC,EAAqBL,EAAS,IAAMC,EAAQK,CAAwB,CAAC,EACrEC,EAAUC,EAAiBC,CAAc,EAEzC,CAAE,EAAAC,GAAMC,IAERC,EAAUZ,EAAS,IAAM,CAC3B,CAAE,MAAOU,EAAE,QAAQ,EAAG,IAAK,SAAU,SAAU,EAAM,EACrD,CAAE,MAAOA,EAAE,MAAM,EAAG,IAAK,MAAO,EAChC,CAAE,MAAOA,EAAE,aAAa,EAAG,IAAK,aAAc,EAC9C,CAAE,MAAOA,EAAE,SAAS,EAAG,IAAK,UAAW,SAAU,EAAM,CAAA,CAC1D,EAEKG,EAAgBb,EAAS,IAC3BG,EAAW,MAAM,MAAMV,EAAM,SAAS,IAAI,EAAE,KAAK,UAAU,EAAE,QAAQI,EAAK,MAAO,MAAM,EAAE,IAAI,CAAA,EAGjGiB,EAAU,IAAM,CACZP,EACK,OAAOQ,EAAc,iBAAkB,IAAMC,EAAO,OAAQ,CAAA,EAC5D,OAAOC,EAAc,QAASd,EAAW,MAAM,MAAM,EACrD,OAAOc,EAAc,OAAQd,EAAW,MAAM,KAAK,EACnD,OAAOc,EAAc,MAAOd,EAAW,MAAM,IAAI,EACjD,OAAOc,EAAc,SAAUd,EAAW,MAAM,MAAM,EACtD,OAAOc,EAAc,QAASd,EAAW,MAAM,MAAM,EACrD,OAAOc,EAAc,gBAAiBd,EAAW,MAAM,cAAc,EACrE,OAAOc,EAAc,aAAcd,EAAW,MAAM,YAAY,EAChE,OAAOc,EAAc,iBAAkBd,EAAW,MAAM,eAAe,EACvE,OAAOc,EAAc,gBAAiBd,EAAW,MAAM,aAAa,CAAA,CAC5E,EAED,SAASe,GAAsB,CACdnB,EAAA,MAAM,MAAMN,EAAM,QAAQ,EAC5BU,EAAA,MAAM,MAAMV,EAAM,OAAO,EACjBY,EAAA,MAAM,MAAMZ,EAAM,gBAAgB,CACzD,CAEA,MAAM0B,EAA8BH,EAAO,GAAG,WAAYE,CAAmB,EACvEE,EAA6BJ,EAAO,GAAG,UAAWE,CAAmB,EAE3E,OAAAG,EAAY,IAAM,CACcF,IACDC,GAAA,CAC9B"}