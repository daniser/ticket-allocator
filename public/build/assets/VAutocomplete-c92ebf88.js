import{p as Ve,bv as be,bw as we,Z as Ce,bx as ke,by as xe,g as Fe,d as Se,r as U,s as I,O as N,f as w,bz as Ie,$ as Pe,bA as Ae,bB as De,bC as W,bD as Re,w as G,B as J,j as _e,aR as X,i as n,ay as T,bE as Me,W as L,bF as Le,bG as Z,bH as Te,b0 as Be,H as q,bI as Ee,aW as Ke,ax as Oe,bJ as Ue,aX as Ne,bK as Q,bL as He}from"./app-c3f923f7.js";function ze(l,h,t){if(h==null)return l;if(Array.isArray(h))throw new Error("Multiple matches is not implemented");return typeof h=="number"&&~h?n(T,null,[n("span",{class:"v-autocomplete__unmask"},[l.substr(0,h)]),n("span",{class:"v-autocomplete__mask"},[l.substr(h,t)]),n("span",{class:"v-autocomplete__unmask"},[l.substr(h+t)])]):l}const $e=Ve({autoSelectFirst:{type:[Boolean,String]},search:String,...be({filterKeys:["title"]}),...we(),...Ce(ke({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...xe({transition:!1})},"VAutocomplete"),We=Fe()({name:"VAutocomplete",props:$e(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,h){let{slots:t}=h;const{t:Y}=Se(),m=U(),V=I(!1),b=I(!0),P=I(!1),H=U(),B=N(l,"menu"),v=w({get:()=>B.value,set:e=>{var a;B.value&&!e&&((a=H.value)!=null&&a.Î¨openChildren)||(B.value=e)}}),i=I(-1),ee=w(()=>{var e;return(e=m.value)==null?void 0:e.color}),{items:A,transformIn:le,transformOut:te}=Ie(l),{textColorClasses:ae,textColorStyles:ue}=Pe(ee),r=N(l,"search",""),p=N(l,"modelValue",[],e=>le(e===null?[null]:He(e)),e=>{const a=te(e);return l.multiple?a:a[0]??null}),F=Ae(),{filteredItems:D,getMatches:ne}=De(l,A,()=>b.value?"":r.value),g=w(()=>p.value.map(e=>A.value.find(a=>{const o=W(a.raw,l.itemValue),y=W(e.raw,l.itemValue);return o===void 0||y===void 0?!1:l.returnObject?l.valueComparator(o,y):l.valueComparator(a.value,e.value)})||e)),C=w(()=>l.hideSelected?D.value.filter(e=>!g.value.some(a=>a.value===e.value)):D.value),E=w(()=>g.value.map(e=>e.props.value)),z=w(()=>g.value[i.value]),R=w(()=>{var a;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&r.value===((a=C.value[0])==null?void 0:a.title))&&C.value.length>0&&!b.value&&!P.value}),K=w(()=>l.hideNoData&&!A.value.length||l.readonly||(F==null?void 0:F.isReadonly.value)),O=U(),{onListScroll:oe,onListKeydown:ie}=Re(O,m);function se(e){l.openOnClear&&(v.value=!0),r.value=""}function re(){K.value||(v.value=!0)}function ce(e){K.value||(V.value&&(e.preventDefault(),e.stopPropagation()),v.value=!v.value)}function ve(e){var y,u,c;if(l.readonly||F!=null&&F.isReadonly.value)return;const a=m.value.selectionStart,o=E.value.length;if((i.value>-1||["Enter","ArrowDown","ArrowUp"].includes(e.key))&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(v.value=!0),["Escape"].includes(e.key)&&(v.value=!1),R.value&&["Enter","Tab"].includes(e.key)&&k(D.value[0]),e.key==="ArrowDown"&&R.value&&((y=O.value)==null||y.focus("next")),!!l.multiple){if(["Backspace","Delete"].includes(e.key)){if(i.value<0){e.key==="Backspace"&&!r.value&&(i.value=o-1);return}const s=i.value;z.value&&k(z.value),i.value=s>=o-1?o-2:s}if(e.key==="ArrowLeft"){if(i.value<0&&a>0)return;const s=i.value>-1?i.value-1:o-1;g.value[s]?i.value=s:(i.value=-1,m.value.setSelectionRange((u=r.value)==null?void 0:u.length,(c=r.value)==null?void 0:c.length))}if(e.key==="ArrowRight"){if(i.value<0)return;const s=i.value+1;g.value[s]?i.value=s:(i.value=-1,m.value.setSelectionRange(0,0))}}}function de(e){r.value=e.target.value}function fe(e){if(Q(m.value,":autofill")||Q(m.value,":-webkit-autofill")){const a=A.value.find(o=>o.title===e.target.value);a&&k(a)}}function me(){var e;V.value&&(b.value=!0,(e=m.value)==null||e.focus())}function pe(e){V.value=!0,setTimeout(()=>{P.value=!0})}function he(e){P.value=!1}function ge(e){(e==null||e===""&&!l.multiple)&&(p.value=[])}const S=I(!1);function k(e){if(l.multiple){const a=E.value.findIndex(o=>l.valueComparator(o,e.value));if(a===-1)p.value=[...p.value,e];else{const o=[...p.value];o.splice(a,1),p.value=o}}else p.value=[e],S.value=!0,r.value=e.title,v.value=!1,b.value=!0,J(()=>S.value=!1)}return G(V,(e,a)=>{var o;e!==a&&(e?(S.value=!0,r.value=l.multiple?"":String(((o=g.value.at(-1))==null?void 0:o.props.title)??""),b.value=!0,J(()=>S.value=!1)):(!l.multiple&&!r.value?p.value=[]:R.value&&!P.value&&!g.value.some(y=>{let{value:u}=y;return u===C.value[0].value})&&k(C.value[0]),v.value=!1,r.value="",i.value=-1))}),G(r,e=>{!V.value||S.value||(e&&(v.value=!0),b.value=!e)}),_e(()=>{const e=!!(l.chips||t.chip),a=!!(!l.hideNoData||C.value.length||t["prepend-item"]||t["append-item"]||t["no-data"]),o=p.value.length>0,[y]=X.filterProps(l);return n(X,L({ref:m},y,{modelValue:r.value,"onUpdate:modelValue":ge,focused:V.value,"onUpdate:focused":u=>V.value=u,validationValue:p.externalValue,dirty:o,onInput:de,onChange:fe,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":v.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!t.selection,"v-autocomplete--selecting-index":i.value>-1},l.class],style:l.style,readonly:l.readonly,placeholder:o?void 0:l.placeholder,"onClick:clear":se,"onMousedown:control":re,onKeydown:ve}),{...t,default:()=>n(T,null,[n(Me,L({ref:H,modelValue:v.value,"onUpdate:modelValue":u=>v.value=u,activator:"parent",contentClass:"v-autocomplete__content",disabled:K.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterLeave:me},l.menuProps),{default:()=>[a&&n(Le,{ref:O,selected:E.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:ie,onFocusin:pe,onFocusout:he,onScrollPassive:oe,tabindex:"-1",color:l.itemColor??l.color},{default:()=>{var u,c,s;return[(u=t["prepend-item"])==null?void 0:u.call(t),!C.value.length&&!l.hideNoData&&(((c=t["no-data"])==null?void 0:c.call(t))??n(Z,{title:Y(l.noDataText)},null)),n(Te,{renderless:!0,items:C.value},{default:x=>{var j;let{item:d,index:f,itemRef:ye}=x;const $=L(d.props,{ref:ye,key:f,active:R.value&&f===0?!0:void 0,onClick:()=>k(d)});return((j=t.item)==null?void 0:j.call(t,{item:d,index:f,props:$}))??n(Z,$,{prepend:_=>{let{isSelected:M}=_;return n(T,null,[l.multiple&&!l.hideSelected?n(Be,{key:d.value,modelValue:M,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependIcon&&n(q,{icon:d.props.prependIcon},null)])},title:()=>{var _,M;return b.value?d.title:ze(d.title,(_=ne(d))==null?void 0:_.title,((M=r.value)==null?void 0:M.length)??0)}})}}),(s=t["append-item"])==null?void 0:s.call(t)]}})]}),g.value.map((u,c)=>{var d;function s(f){f.stopPropagation(),f.preventDefault(),k(u)}const x={"onClick:close":s,onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return n("div",{key:u.value,class:["v-autocomplete__selection",c===i.value&&["v-autocomplete__selection--selected",ae.value]],style:c===i.value?ue.value:{}},[e?t.chip?n(Ke,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:u.title}}},{default:()=>{var f;return[(f=t.chip)==null?void 0:f.call(t,{item:u,index:c,props:x})]}}):n(Ee,L({key:"chip",closable:l.closableChips,size:"small",text:u.title},x),null):((d=t.selection)==null?void 0:d.call(t,{item:u,index:c}))??n("span",{class:"v-autocomplete__selection-text"},[u.title,l.multiple&&c<g.value.length-1&&n("span",{class:"v-autocomplete__selection-comma"},[Oe(",")])])])})]),"append-inner":function(){var x;for(var u=arguments.length,c=new Array(u),s=0;s<u;s++)c[s]=arguments[s];return n(T,null,[(x=t["append-inner"])==null?void 0:x.call(t,...c),l.menuIcon?n(q,{class:"v-autocomplete__menu-icon",icon:l.menuIcon,onMousedown:ce,onClick:Ue},null):void 0])}})}),Ne({isFocused:V,isPristine:b,menu:v,search:r,filteredItems:D,select:k},m)}});export{We as V};
//# sourceMappingURL=VAutocomplete-c92ebf88.js.map
