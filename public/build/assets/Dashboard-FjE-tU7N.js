import{T as Re}from"./TransitionGroup-DvaGSdcG.js";import{k as Me,p as Z,m as Ee,a as Pe,b as Qe,g as K,c as et,u as tt,d as ot,e as nt,r as W,f as c,s as ye,w as Ae,h as at,i as r,V as A,j as q,l as We,n as st,o as lt,q as Oe,t as it,v as ut,x as rt,M as ct,y as pe,z as dt,A as De,B as vt,C as ft,F as j,D as F,E as Le,G as mt,H as ht,I as yt,J as X,K as pt,L as gt,N as kt,O as ne,P as bt,Q as _t,R as Se,S as ee,T as w,U as I,W as h,X as M,Y as Ue,Z as Y,_ as i,$ as v,a0 as B,a1 as $,a2 as oe,a3 as ce,a4 as ae,a5 as ue,a6 as He,a7 as wt,a8 as ie,a9 as N,aa as G,ab as je,ac as Vt,ad as $t,ae as me,af as Ct,ag as xt,ah as Tt,ai as St}from"./app-9F_l98Gd.js";import{u as z,i as It,M as Bt,a as Rt,b as Xe,c as Ye,d as Mt,e as Et,T as Ne,f as Pt,g as At,C as Wt,O as L,h as U,j as Ot,k as Dt,l as Lt,V as Ut}from"./OperatorRepository-BmcASi3c.js";import{m as Ht,u as jt,a as Xt,V as Ie,b as Yt}from"./filter-D3qOwDtQ.js";import{V as Nt,a as Gt}from"./VCard-9o2TS-vm.js";import{f as zt,a as Ft,s as Zt}from"./VTextField-DjotwDm7.js";import{V as Be,a as he}from"./VRow-DFzC9iIC.js";import{V as Kt}from"./VAutocomplete-B9KBniJh.js";import{V as qt}from"./VContainer-C0Dg1Rrh.js";import{V as Jt}from"./VTable-DP_EuNQy.js";import"./VInput-oAey8Zi4.js";import"./VSelectionControl-CVKUbszx.js";import"./VCheckboxBtn-BbRBoctq.js";/* empty css              */const Qt=e=>{const{touchstartX:t,touchendX:o,touchstartY:n,touchendY:l}=e,a=.5,s=16;e.offsetX=o-t,e.offsetY=l-n,Math.abs(e.offsetY)<a*Math.abs(e.offsetX)&&(e.left&&o<t-s&&e.left(e),e.right&&o>t+s&&e.right(e)),Math.abs(e.offsetX)<a*Math.abs(e.offsetY)&&(e.up&&l<n-s&&e.up(e),e.down&&l>n+s&&e.down(e))};function eo(e,t){var n;const o=e.changedTouches[0];t.touchstartX=o.clientX,t.touchstartY=o.clientY,(n=t.start)==null||n.call(t,{originalEvent:e,...t})}function to(e,t){var n;const o=e.changedTouches[0];t.touchendX=o.clientX,t.touchendY=o.clientY,(n=t.end)==null||n.call(t,{originalEvent:e,...t}),Qt(t)}function oo(e,t){var n;const o=e.changedTouches[0];t.touchmoveX=o.clientX,t.touchmoveY=o.clientY,(n=t.move)==null||n.call(t,{originalEvent:e,...t})}function no(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:o=>eo(o,t),touchend:o=>to(o,t),touchmove:o=>oo(o,t)}}function ao(e,t){var f;const o=t.value,n=o!=null&&o.parent?e.parentElement:e,l=(o==null?void 0:o.options)??{passive:!0},a=(f=t.instance)==null?void 0:f.$.uid;if(!n||!a)return;const s=no(t.value);n._touchHandlers=n._touchHandlers??Object.create(null),n._touchHandlers[a]=s,Me(s).forEach(g=>{n.addEventListener(g,s[g],l)})}function so(e,t){var a,s;const o=(a=t.value)!=null&&a.parent?e.parentElement:e,n=(s=t.instance)==null?void 0:s.$.uid;if(!(o!=null&&o._touchHandlers)||!n)return;const l=o._touchHandlers[n];Me(l).forEach(f=>{o.removeEventListener(f,l[f])}),delete o._touchHandlers[n]}const Ge={mounted:ao,unmounted:so},ze=Symbol.for("vuetify:v-window"),Fe=Symbol.for("vuetify:v-window-group"),Ze=Z({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Ee(),...Pe(),...Qe()},"VWindow"),ge=K()({name:"VWindow",directives:{Touch:Ge},props:Ze(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const{themeClasses:n}=et(e),{isRtl:l}=tt(),{t:a}=ot(),s=nt(e,Fe),f=W(),g=c(()=>l.value?!e.reverse:e.reverse),d=ye(!1),k=c(()=>{const m=e.direction==="vertical"?"y":"x",C=(g.value?!d.value:d.value)?"-reverse":"";return`v-window-${m}${C}-transition`}),x=ye(0),y=W(void 0),V=c(()=>s.items.value.findIndex(m=>s.selected.value.includes(m.id)));Ae(V,(m,p)=>{const C=s.items.value.length,S=C-1;C<=2?d.value=m<p:m===S&&p===0?d.value=!0:m===0&&p===S?d.value=!1:d.value=m<p}),at(ze,{transition:k,isReversed:d,transitionCount:x,transitionHeight:y,rootRef:f});const _=c(()=>e.continuous||V.value!==0),T=c(()=>e.continuous||V.value!==s.items.value.length-1);function O(){_.value&&s.prev()}function H(){T.value&&s.next()}const E=c(()=>{const m=[],p={icon:l.value?e.nextIcon:e.prevIcon,class:`v-window__${g.value?"right":"left"}`,onClick:s.prev,"aria-label":a("$vuetify.carousel.prev")};m.push(_.value?o.prev?o.prev({props:p}):r(A,p,null):r("div",null,null));const C={icon:l.value?e.prevIcon:e.nextIcon,class:`v-window__${g.value?"left":"right"}`,onClick:s.next,"aria-label":a("$vuetify.carousel.next")};return m.push(T.value?o.next?o.next({props:C}):r(A,C,null):r("div",null,null)),m}),b=c(()=>e.touch===!1?e.touch:{...{left:()=>{g.value?O():H()},right:()=>{g.value?H():O()},start:p=>{let{originalEvent:C}=p;C.stopPropagation()}},...e.touch===!0?{}:e.touch});return q(()=>We(r(e.tag,{ref:f,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},n.value,e.class],style:e.style},{default:()=>{var m,p;return[r("div",{class:"v-window__container",style:{height:y.value}},[(m=o.default)==null?void 0:m.call(o,{group:s}),e.showArrows!==!1&&r("div",{class:"v-window__controls"},[E.value])]),(p=o.additional)==null?void 0:p.call(o,{group:s})]}}),[[st("touch"),b.value]])),{group:s}}}),Ke=Z({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ee(),...lt(),...Ht()},"VWindowItem"),te=K()({name:"VWindowItem",directives:{Touch:Ge},props:Ke(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:o}=t;const n=Oe(ze),l=it(e,Fe),{isBooted:a}=ut();if(!n||!l)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=ye(!1),f=c(()=>a.value&&(n.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function g(){!s.value||!n||(s.value=!1,n.transitionCount.value>0&&(n.transitionCount.value-=1,n.transitionCount.value===0&&(n.transitionHeight.value=void 0)))}function d(){var _;s.value||!n||(s.value=!0,n.transitionCount.value===0&&(n.transitionHeight.value=pe((_=n.rootRef.value)==null?void 0:_.clientHeight)),n.transitionCount.value+=1)}function k(){g()}function x(_){s.value&&dt(()=>{!f.value||!s.value||!n||(n.transitionHeight.value=pe(_.clientHeight))})}const y=c(()=>{const _=n.isReversed.value?e.reverseTransition:e.transition;return f.value?{name:typeof _!="string"?n.transition.value:_,onBeforeEnter:d,onAfterEnter:g,onEnterCancelled:k,onBeforeLeave:d,onAfterLeave:g,onLeaveCancelled:k,onEnter:x}:!1}),{hasContent:V}=jt(e,l.isSelected);return q(()=>r(ct,{transition:y.value,disabled:!a.value},{default:()=>{var _;return[We(r("div",{class:["v-window-item",l.selectedClass.value,e.class],style:e.style},[V.value&&((_=o.default)==null?void 0:_.call(o))]),[[rt,l.isSelected.value]])]}})),{groupItem:l}}}),ke=Symbol.for("vuetify:v-tabs"),lo=Z({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...De(vt({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),re=K()({name:"VTab",props:lo(),setup(e,t){let{slots:o,attrs:n}=t;const{textColorClasses:l,textColorStyles:a}=ft(e,"sliderColor"),s=W(),f=W(),g=c(()=>e.direction==="horizontal"),d=c(()=>{var x,y;return((y=(x=s.value)==null?void 0:x.group)==null?void 0:y.isSelected.value)??!1});function k(x){var V,_;let{value:y}=x;if(y){const T=(_=(V=s.value)==null?void 0:V.$el.parentElement)==null?void 0:_.querySelector(".v-tab--selected .v-tab__slider"),O=f.value;if(!T||!O)return;const H=getComputedStyle(T).color,E=T.getBoundingClientRect(),b=O.getBoundingClientRect(),m=g.value?"x":"y",p=g.value?"X":"Y",C=g.value?"right":"bottom",S=g.value?"width":"height",J=E[m],de=b[m],D=J>de?E[C]-b[C]:E[m]-b[m],ve=Math.sign(D)>0?g.value?"right":"bottom":Math.sign(D)<0?g.value?"left":"top":"center",fe=(Math.abs(D)+(Math.sign(D)<0?E[S]:b[S]))/Math.max(E[S],b[S])||0,Q=E[S]/b[S]||0,se=1.5;Ft(O,{backgroundColor:[H,"currentcolor"],transform:[`translate${p}(${D}px) scale${p}(${Q})`,`translate${p}(${D/se}px) scale${p}(${(fe-1)/se+1})`,"none"],transformOrigin:Array(3).fill(ve)},{duration:225,easing:Zt})}}return q(()=>{const x=A.filterProps(e);return r(A,F({symbol:ke,ref:s,class:["v-tab",e.class],style:e.style,tabindex:d.value?0:-1,role:"tab","aria-selected":String(d.value),active:!1},x,n,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":k}),{...o,default:()=>{var y;return r(j,null,[((y=o.default)==null?void 0:y.call(o))??e.text,!e.hideSlider&&r("div",{ref:f,class:["v-tab__slider",l.value],style:a.value},null)])}})}),zt({},s)}}),io=Z({...De(Ze(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),uo=K()({name:"VTabsWindow",props:io(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const n=Oe(ke,null),l=Le(e,"modelValue"),a=c({get(){var s;return l.value!=null||!n?l.value:(s=n.items.value.find(f=>n.selected.value.includes(f.id)))==null?void 0:s.value},set(s){l.value=s}});return q(()=>{const s=ge.filterProps(e);return r(ge,F({_as:"VTabsWindow"},s,{modelValue:a.value,"onUpdate:modelValue":f=>a.value=f,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),o)}),{}}}),ro=Z({...Ke()},"VTabsWindowItem"),co=K()({name:"VTabsWindowItem",props:ro(),setup(e,t){let{slots:o}=t;return q(()=>{const n=te.filterProps(e);return r(te,F({_as:"VTabsWindowItem"},n,{class:["v-tabs-window-item",e.class],style:e.style}),o)}),{}}});function vo(e){return e?e.map(t=>kt(t)?t:{text:t,value:t}):[]}const fo=Z({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Xt({mandatory:"force",selectedClass:"v-tab-item--selected"}),...mt(),...Pe()},"VTabs"),mo=K()({name:"VTabs",props:fo(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:o,slots:n}=t;const l=Le(e,"modelValue"),a=c(()=>vo(e.items)),{densityClasses:s}=ht(e),{backgroundColorClasses:f,backgroundColorStyles:g}=yt(X(e,"bgColor")),{scopeId:d}=pt();return gt({VTab:{color:X(e,"color"),direction:X(e,"direction"),stacked:X(e,"stacked"),fixed:X(e,"fixedTabs"),sliderColor:X(e,"sliderColor"),hideSlider:X(e,"hideSlider")}}),q(()=>{const k=Ie.filterProps(e),x=!!(n.window||e.items.length>0);return r(j,null,[r(Ie,F(k,{modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},s.value,f.value,e.class],style:[{"--v-tabs-height":pe(e.height)},g.value,e.style],role:"tablist",symbol:ke},d,o),{default:()=>{var y;return[((y=n.default)==null?void 0:y.call(n))??a.value.map(V=>{var _;return((_=n.tab)==null?void 0:_.call(n,{item:V}))??r(re,F(V,{key:V.text,value:V.value}),{default:n[`tab.${V.value}`]?()=>{var T;return(T=n[`tab.${V.value}`])==null?void 0:T.call(n,{item:V})}:void 0})})]}}),x&&r(uo,F({modelValue:l.value,"onUpdate:modelValue":y=>l.value=y,key:"tabs-window"},d),{default:()=>{var y;return[a.value.map(V=>{var _;return((_=n.item)==null?void 0:_.call(n,{item:V}))??r(co,{value:V.value},{default:()=>{var T;return(T=n[`item.${V.value}`])==null?void 0:T.call(n,{item:V})}})}),(y=n.window)==null?void 0:y.call(n)]}})])}),{}}});function ho(e,t){const o=W();return z(e,"dragstart",n=>{if(o.value=n.target,typeof t=="string"){const l=t;t=(a,s)=>{s==null||s.setData("text/plain",a.dataset[l]??"")}}t==null||t(o.value,n.dataTransfer)}),z(e,"dragend",()=>{o.value=null}),{element:o}}function qe(e,t,o=!0){const n=W(!1);let l=0;return It&&(z(e,"dragenter",a=>{a.preventDefault(),l++,n.value=!0}),z(e,"dragover",a=>{a.preventDefault()}),z(e,"dragleave",a=>{a.preventDefault(),l--,l===0&&(n.value=!1)}),z(e,"drop",a=>{var s;if(a.preventDefault(),l=0,n.value=!1,t)if(o){const f=Array.from(((s=a.dataTransfer)==null?void 0:s.files)??[]);t(f.length===0?null:f)}else t(a.dataTransfer)})),{isOverDropZone:n}}const yo={class:"d-inline-block"},po={class:"text-white overflow-hidden"},go={class:"title inline-block relative"},ko=["innerHTML"],bo={key:1},_o=["innerHTML"],wo={key:0},Vo={key:1},$o={key:2},Co={key:3},xo={class:"table-fixed"},To={class:"w-1/3"},So={class:"text-center"},Io=["title"],Bo={class:"text-center"},Ro=["title"],Mo={class:"text-center"},Eo=["title"],Po={class:"text-center"},Ao=["title"],Wo={class:"text-center"},Oo=["title"],Do={class:"text-right"},Lo={class:"text-right"},Uo={class:"text-right"},Ho={class:"text-right"},jo={class:"text-right"},Xo={class:"text-right"},Yo={class:"text-right"},No={class:"text-right"},Go={class:"text-right"},zo={class:"text-right"},Fo=ne({__name:"Ticket",props:{ticket:{}},setup(e){bt(u=>({"089ed14c":Ve.value.delay,fb3395aa:Ve.value.duration}));const t=e,{t:o}=_t(),n=c(()=>Se().props.factors),l=W(null),a=new Bt({linkify:!0}).use(Rt),s=Xe(),f=Ye(),g=c(()=>Se().props.options),d=c(()=>ee(t.ticket.created_at)),k=c(()=>ee.duration(t.ticket.delay,"s")),x=c(()=>d.value.add(k.value)),y=c(()=>t.ticket.bound_at?ee(t.ticket.bound_at):null),V=c(()=>t.ticket.reservation?ee.duration(t.ticket.reservation,"s"):null),_=c(()=>y.value&&V.value?y.value.add(V.value):null),T=c(()=>t.ticket.accepted_at?ee(t.ticket.accepted_at):null),O=c(()=>`${d.value.format("lll")} (${d.value.fromNow()})`),H=c(()=>`${x.value.format("lll")} (${o("time_left",{time:x.value.fromNow(!0)})})`),E=c(()=>y.value?`${y.value.format("lll")} (${y.value.fromNow()})`:null),b=c(()=>_.value?`${_.value.format("lll")} (${o("time_left",{time:_.value.fromNow(!0)})})`:null),m=c(()=>T.value?`${T.value.format("lll")} (${T.value.fromNow()})`:null),p=c(()=>`${J(t.ticket.weight)} (${o("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),C=c(()=>g.value[`${f.value}_threshold`]),S=c(()=>t.ticket[f.value]),J=u=>u<1e5?u:u.toExponential(1),de=()=>{var u,R;return((u=t.ticket.meta)==null?void 0:u.category_name)??((R=t.ticket.category)==null?void 0:R.name)??""},D=()=>{var u,R;return((u=t.ticket.meta)==null?void 0:u.category_short)??((R=t.ticket.category)==null?void 0:R.short)??""},ve=()=>{var u;return s.altInfo?((u=t.ticket.meta)==null?void 0:u.title)??D():D()},we=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_title)??"Title"}),fe=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_subtitle)??de()}),Q=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_content)??[]}),se=c(()=>S.value>C.value),Ve=c(()=>({delay:-S.value+"s",duration:C.value+"s"}));return(u,R)=>(w(),I("div",yo,[r(A,{size:"small",class:ce(["ticket justify-start px-2",{overflow:se.value}]),ripple:!1,flat:"",width:"100"},{default:h(()=>{var $e,Ce;return[($e=u.ticket.meta)!=null&&$e.icon?(w(),M(Ue,{key:0,icon:((Ce=u.ticket.meta)==null?void 0:Ce.icon)??"",color:"white"},null,8,["icon"])):Y("",!0),i("span",po,[i("span",go,v(ve()),1)]),r(Yt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:h(()=>{var xe;return[r(Nt,{width:"500","prepend-icon":((xe=u.ticket.meta)==null?void 0:xe.icon)??"",title:we.value,subtitle:fe.value},{default:h(()=>[r(mo,{modelValue:l.value,"onUpdate:modelValue":R[0]||(R[0]=P=>l.value=P)},{default:h(()=>[r(re,{value:"properties"},{default:h(()=>[B(v(u.$t("properties")),1)]),_:1}),r(re,{value:"metrics"},{default:h(()=>[B(v(u.$t("metrics")),1)]),_:1}),r(re,{value:"details"},{default:h(()=>[B(v(u.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Gt,null,{default:h(()=>[r(ge,{modelValue:l.value,"onUpdate:modelValue":R[1]||(R[1]=P=>l.value=P)},{default:h(()=>[r(te,{value:"properties",class:"prose"},{default:h(()=>[typeof Q.value=="string"?(w(),I("div",{key:0,innerHTML:$(a).render(Q.value)},null,8,ko)):(w(),I("table",bo,[i("tbody",null,[(w(!0),I(j,null,oe(Q.value,([P,le])=>(w(),I("tr",{key:P},[i("th",null,v(P),1),i("td",{innerHTML:$(a).renderInline(le)},null,8,_o)]))),128))])]))]),_:1}),r(te,{value:"metrics",class:"prose"},{default:h(()=>[i("table",null,[i("tbody",null,[i("tr",null,[i("th",null,v(u.$t("issued_on")),1),i("td",null,v(O.value),1)]),x.value.isAfter(u.$dayjs())?(w(),I("tr",wo,[i("th",null,v(u.$t("delayed_until")),1),i("td",null,v(H.value),1)])):Y("",!0),y.value?(w(),I("tr",Vo,[i("th",null,v(u.$t("bound_at")),1),i("td",null,v(E.value),1)])):Y("",!0),_.value&&_.value.isAfter(u.$dayjs())?(w(),I("tr",$o,[i("th",null,v(u.$t("reserved_until")),1),i("td",null,v(b.value),1)])):Y("",!0),T.value?(w(),I("tr",Co,[i("th",null,v(u.$t("accepted_at")),1),i("td",null,v(m.value),1)])):Y("",!0),i("tr",null,[i("th",null,v(u.$t("current_weight")),1),i("td",null,v(p.value),1)]),i("tr",null,[i("th",null,v(u.$t("complexity")),1),i("td",null,v(u.ticket.complexity+" "+$(o)("units")),1)])])])]),_:1}),r(te,{value:"details",class:"prose"},{default:h(()=>[i("table",xo,[i("thead",null,[i("tr",null,[i("th",To,v(u.$t("factor")),1),i("th",So,[i("em",{class:"metric",title:u.$t("initial_weight")},R[2]||(R[2]=[B("W"),i("sub",null,"0",-1)]),8,Io)]),i("th",Bo,[i("em",{class:"metric",title:u.$t("weight_increment")},R[3]||(R[3]=[B("W"),i("sub",null,"i",-1)]),8,Ro)]),i("th",Mo,[i("em",{class:"metric",title:u.$t("complexity")},"C",8,Eo)]),i("th",Po,[i("em",{class:"metric",title:u.$t("delay_sec")},"D",8,Ao)]),i("th",Wo,[i("em",{class:"metric",title:u.$t("reservation_sec")},"R",8,Oo)])])]),i("tbody",null,[(w(!0),I(j,null,oe(u.ticket.metrics??{},(P,le)=>{var Te;return w(),I("tr",{key:le},[i("th",null,v(((Te=n.value[le])==null?void 0:Te.name)??u.$t("unknown")),1),i("td",Do,v(P.initial_weight??0),1),i("td",Lo,v(P.weight_increment??0),1),i("td",Uo,v(P.complexity??0),1),i("td",Ho,v(P.delay??0),1),i("td",jo,v(P.reservation??0),1)])}),128))]),i("tfoot",null,[i("tr",null,[i("th",null,v(u.$t("total")),1),i("td",Xo,v(u.ticket.initial_weight),1),i("td",Yo,v(u.ticket.weight_increment),1),i("td",No,v(u.ticket.complexity),1),i("td",Go,v(u.ticket.delay),1),i("td",zo,v(u.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]}),_:1})]}),_:1},8,["class"])]))}}),Zo=ae(Fo,[["__scopeId","data-v-59edf879"]]),Ko=ne({__name:"TicketPool",props:{tickets:{}},setup(e){const t=W(null);ho(t,"uuid");const{lock:o,unlock:n,element:l,triggerElement:a}=Mt(t),{x:s}=Et({type:"movement"});c(()=>ue(Ne)),Ae([l,s],([g,d])=>{!g||!a.value||a.value.dataset.uuid});const f=W(!1);return He(()=>{setTimeout(()=>f.value=!0,500)}),(g,d)=>(w(),M($(Re),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"@container tickets leading-8 !pt-[1px] !pb-[3px]",css:f.value,onMouseup:$(n)},{default:h(()=>[(w(!0),I(j,null,oe(g.tickets,k=>(w(),M(Zo,{key:k.uuid,"data-uuid":k.uuid,ticket:k,draggable:"true",class:"mr-1",onMousedown:wt($(o),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),qo=ae(Ko,[["__scopeId","data-v-ba6baa0a"]]);function be(){async function e(l,a){return await window.axios.patch(ie("ticket-allocator.operators.ready",l),{ready:a})}async function t(l,a){return await window.axios.patch(ie("ticket-allocator.tickets.weight",l),{weight_points:a})}async function o(l,a){return await window.axios.patch(ie("ticket-allocator.tickets.handler",l),{operator_uuid:a??null})}async function n(l){return await window.axios.delete(ie("ticket-allocator.tickets.close",l))}return{ready:e,weight:t,handler:o,close:n}}const Jo=ne({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let o=W(!1);const n=c(()=>t.pool?"th":"td"),l=c(()=>t.tickets.reduce((d,{complexity:k})=>d+k,0)),a=c(()=>o.value?"mdi-chevron-down":"mdi-chevron-up"),s=be(),f=W(null),{isOverDropZone:g}=qe(f,async d=>{var y;const k=d==null?void 0:d.getData("text/plain");if(!k)throw new Error("Ticket UUID undefined.");const x=(y=f.value)==null?void 0:y.dataset.uuid;return await s.handler(k,x)},!1);return(d,k)=>(w(),I("tr",{ref_key:"ticketRow",ref:f,class:ce(["ticket-row",{dragover:$(g)}])},[(w(),M(G(n.value),{class:"status py-1"},{default:h(()=>[N(d.$slots,"status",{},void 0,!0)]),_:3})),(w(),M(G(n.value),{class:"name !pt-[6px] font-weight-bold"},{default:h(()=>[N(d.$slots,"name",{},void 0,!0)]),_:3})),(w(),M(G(n.value),{class:"load !pt-[6px] text-center"},{default:h(()=>[N(d.$slots,"load",{},()=>[B(v(d.tickets.length),1)],!0),k[2]||(k[2]=B("/")),N(d.$slots,"load-max",{},()=>[k[1]||(k[1]=B("∞"))],!0)]),_:3})),(w(),M(G(n.value),{class:"complexity !pt-[6px] text-center"},{default:h(()=>[N(d.$slots,"complexity",{},()=>[B(v(l.value),1)],!0),k[4]||(k[4]=B("/")),N(d.$slots,"complexity-max",{},()=>[k[3]||(k[3]=B("∞"))],!0)]),_:3})),r(qo,{tag:n.value,tickets:d.tickets,class:ce({collapsed:$(o)})},null,8,["tag","tickets","class"]),(w(),M(G(n.value),{class:"more !pt-[2px] text-center"},{default:h(()=>[r(A,{size:"x-small",variant:"tonal",icon:a.value,onClick:k[0]||(k[0]=x=>je(o)?o.value=!$(o):o=!$(o))},null,8,["icon"])]),_:1}))],2))}}),Je=ae(Jo,[["__scopeId","data-v-62b3ff4d"]]),Qo=ne({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,o=c(()=>{var a,s;return{online:t.operator.online,ready:t.operator.ready,busy:!!((a=t.operator.tickets)!=null&&a.length),full:t.operator.ticket_limit!==null&&((s=t.operator.tickets)==null?void 0:s.length)>=t.operator.ticket_limit}}),n=be(),l=async()=>await n.ready(t.operator.uuid,!t.operator.ready);return(a,s)=>(w(),M(Je,{tickets:a.operator.tickets,"data-uuid":a.operator.uuid,class:ce(["operator",o.value])},{status:h(()=>[r(Ue,{icon:"mdi-account",onClick:l})]),"load-max":h(()=>[B(v(a.operator.ticket_limit??"∞"),1)]),"complexity-max":h(()=>[B(v(a.operator.complexity_limit??"∞"),1)]),name:h(()=>[B(v(a.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),en=ae(Qo,[["__scopeId","data-v-a776c74a"]]);function tn(e,t){return e.reduce((o,n)=>(typeof n[t]=="number"&&(o+=n[t]),o),0)}function _e(e,t){return e.map(o=>Vt(o,t)).filter(o=>o)}function on(e,t){const o=_e(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.max(...o)}function nn(e,t){const o=_e(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.min(...o)}function an(e){return e.map(t=>t[t.$getLocalKey()])}function sn(e,t){const o={},n=Array.isArray(t)?t:[t];return e.forEach(l=>{const a=n.length===1?l[n[0]]:`[${n.map(s=>l[s]).toString()}]`;o[a]=(o[a]||[]).concat(l)}),o}function ln(e,t,o){const n=[],l=[];return typeof t=="function"&&l.push(t)&&n.push("asc"),Array.isArray(t)&&t.forEach(a=>l.push(a[0])&&n.push(a[1])),l.length===0&&l.push(t),$t(e,l,n,o)}function un(e){return{sum:t=>tn(e,t),min:t=>nn(e,t),max:t=>on(e,t),pluck:t=>_e(e,t),groupBy:t=>sn(e,t),sortBy:(t,o="SORT_REGULAR")=>ln(e,t,o),keys:()=>an(e)}}const rn={class:"font-semibold text-xl text-gray-800 leading-tight"},cn={class:"align-top"},dn=ne({__name:"Dashboard",props:{layout:{default:"default"},operators:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,o=Xe(),n=Ye(),l=Pt(),a=c(()=>ue(Dt)),s=c(()=>ue(Ne)),f=c(()=>ue(Lt)),g=At(Ot),d=b=>Object.entries(l.value).reduce((m,[p,C])=>{const S=b==null?void 0:b[p],J=S===void 0||!C.length||C.map(String).includes(S.toString());return m&&J},!0),k=c(()=>un(a.value.with("tickets",b=>{b.with("category").where("meta",d).orderBy(n.value,"desc")}).whereHas("tickets").orWhere(b=>!o.hideEmpty&&b.online).get()).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),x=c(()=>s.value.unbound().with("category").where("meta",d).orderBy(n.value,"desc").get()),y=be(),V=W(null),{isOverDropZone:_}=qe(V,async b=>{const m=b==null?void 0:b.getData("text/plain");if(!m)throw new Error("Ticket UUID undefined.");return await y.close(m)},!1);He(()=>{g.listen(Wt.PropsInvalidated,()=>me.reload()).listen(L.Enrolled,a.value.enroll).listen(L.Resigned,a.value.resign).listen(L.NameChanged,a.value.changeName).listen(L.Online,a.value.setOnline).listen(L.Offline,a.value.setOffline).listen(L.Ready,a.value.setReady).listen(L.NotReady,a.value.setNotReady).listen(L.TicketLimitAdjusted,a.value.adjustTicketLimit).listen(L.ComplexityLimitAdjusted,a.value.adjustComplexityLimit).listen(U.Created,s.value.create).listen(U.Closed,s.value.close).listen(U.Bound,s.value.bind).listen(U.Accepted,s.value.accept).listen(U.Unbound,s.value.unbind).listen(U.CategoryChanged,s.value.changeCategory).listen(U.MetaValueSet,s.value.setMetaValue).listen(U.MetaValuesMerged,s.value.mergeMetaValues).listen(U.MetricsAdjusted,s.value.adjustMetrics)});function T(){a.value.fresh(t.operators),s.value.fresh(t.tickets),f.value.fresh(t.ticketCategories)}const O=me.on("navigate",T),H=me.on("success",T);Ct(()=>{O(),H()});const E=b=>Object.entries(b).map(([m,p])=>({title:m,value:p}));return(b,m)=>(w(),I(j,null,[r($(xt),{title:b.$t("dashboard")},null,8,["title"]),(w(),M(G(`${b.layout}-layout`),null,{header:h(()=>[i("h2",rn,v(b.$t("dashboard")),1)]),default:h(()=>[i("div",null,[r(qt,{fluid:""},{default:h(()=>[r(Be,null,{default:h(()=>[r(he,null,{default:h(()=>[r(Tt,{modelValue:$(o).all,"onUpdate:modelValue":m[0]||(m[0]=p=>$(o).all=p),variant:"plain",multiple:""},{default:h(()=>[r(A,{value:"show-filters",icon:$(o).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(A,{value:"hide-empty",icon:$(o).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(A,{value:"alt-info",icon:$(o).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(A,{value:"unlocked",icon:$(o).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:$(o).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),$(o).unlocked?(w(),M(St,{key:0,variant:"plain"},{default:h(()=>[r(A,{ref_key:"closeTicket",ref:V,icon:$(_)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(A,{icon:"mdi-refresh"})]),_:1})):Y("",!0)]),_:1}),r(he,{cols:"2"},{default:h(()=>[r(Ut,{modelValue:$(n),"onUpdate:modelValue":m[1]||(m[1]=p=>je(n)?n.value=p:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),$(o).showFilters?(w(),M(Be,{key:0},{default:h(()=>[(w(!0),I(j,null,oe(b.matchers,(p,C)=>(w(),M(he,{key:C,cols:"2"},{default:h(()=>[r(Kt,{modelValue:$(l)[C],"onUpdate:modelValue":S=>$(l)[C]=S,multiple:"",clearable:"",chips:"","closable-chips":"",label:b.$t(C),items:E(p)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):Y("",!0)]),_:1}),r(Jt,{"fixed-header":"",height:"600px",density:"compact",class:"ticket-monitor"},{default:h(()=>[i("thead",cn,[r(Je,{pool:"",tickets:x.value},{name:h(()=>[B(v(b.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r($(Re),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:h(()=>[(w(!0),I(j,null,oe(k.value,p=>(w(),M(en,{key:p.uuid,operator:p},null,8,["operator"]))),128))]),_:1})]),_:1})])]),_:1}))],64))}}),xn=ae(dn,[["__scopeId","data-v-b089b931"]]);export{xn as default};
//# sourceMappingURL=Dashboard-FjE-tU7N.js.map
