import{T as Re}from"./TransitionGroup-CgK8i6DK.js";import{k as Me,p as Z,m as Ee,a as Pe,b as Qe,g as K,c as et,u as tt,d as ot,e as nt,r as W,f as c,s as ye,w as Ae,h as at,i as r,V as A,j as q,l as We,n as st,o as lt,q as Oe,t as it,v as ut,x as rt,M as ct,y as pe,z as dt,A as De,B as vt,C as ft,F as j,D as F,E as Le,G as mt,H as ht,I as yt,J as X,K as pt,L as gt,N as kt,O as ne,P as bt,Q as _t,R as Se,S as ee,T as w,U as I,W as h,X as M,Y as Ue,Z as Y,_ as i,$ as v,a0 as B,a1 as C,a2 as oe,a3 as ce,a4 as ae,a5 as ue,a6 as He,a7 as wt,a8 as ie,a9 as G,aa as N,ab as je,ac as Vt,ad as $t,ae as Ct,af as me,ag as xt,ah as Tt,ai as St,aj as It}from"./app-Byix2Jvx.js";import{u as z,i as Bt,M as Rt,a as Mt,b as Xe,c as Ye,d as Et,e as Pt,T as Ge,f as At,C as Wt,O as L,g as U,h as Ot,j as Dt,k as Lt,V as Ut}from"./OperatorRepository-CelU_IiB.js";import{m as Ht,u as jt,a as Xt,V as Ie,b as Yt}from"./filter-BsHTL8N-.js";import{V as Gt,a as Nt}from"./VCard-BFBSM-Be.js";import{f as zt,a as Ft,s as Zt}from"./VTextField-e1-Lf1Rz.js";import{V as Be,a as he}from"./VRow-18YmOgQX.js";import{V as Kt}from"./VAutocomplete-DX_rs385.js";import{V as qt}from"./VContainer-Dx9GY-MF.js";import{V as Jt}from"./VTable-DtlND8qW.js";import"./VInput-BEjnzIcO.js";import"./VSelectionControl-BDpqptwA.js";import"./VCheckboxBtn-CQc-Dyhs.js";/* empty css              */const Qt=e=>{const{touchstartX:t,touchendX:o,touchstartY:n,touchendY:a}=e,s=.5,l=16;e.offsetX=o-t,e.offsetY=a-n,Math.abs(e.offsetY)<s*Math.abs(e.offsetX)&&(e.left&&o<t-l&&e.left(e),e.right&&o>t+l&&e.right(e)),Math.abs(e.offsetX)<s*Math.abs(e.offsetY)&&(e.up&&a<n-l&&e.up(e),e.down&&a>n+l&&e.down(e))};function eo(e,t){var n;const o=e.changedTouches[0];t.touchstartX=o.clientX,t.touchstartY=o.clientY,(n=t.start)==null||n.call(t,{originalEvent:e,...t})}function to(e,t){var n;const o=e.changedTouches[0];t.touchendX=o.clientX,t.touchendY=o.clientY,(n=t.end)==null||n.call(t,{originalEvent:e,...t}),Qt(t)}function oo(e,t){var n;const o=e.changedTouches[0];t.touchmoveX=o.clientX,t.touchmoveY=o.clientY,(n=t.move)==null||n.call(t,{originalEvent:e,...t})}function no(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:o=>eo(o,t),touchend:o=>to(o,t),touchmove:o=>oo(o,t)}}function ao(e,t){var f;const o=t.value,n=o!=null&&o.parent?e.parentElement:e,a=(o==null?void 0:o.options)??{passive:!0},s=(f=t.instance)==null?void 0:f.$.uid;if(!n||!s)return;const l=no(t.value);n._touchHandlers=n._touchHandlers??Object.create(null),n._touchHandlers[s]=l,Me(l).forEach(y=>{n.addEventListener(y,l[y],a)})}function so(e,t){var s,l;const o=(s=t.value)!=null&&s.parent?e.parentElement:e,n=(l=t.instance)==null?void 0:l.$.uid;if(!(o!=null&&o._touchHandlers)||!n)return;const a=o._touchHandlers[n];Me(a).forEach(f=>{o.removeEventListener(f,a[f])}),delete o._touchHandlers[n]}const Ne={mounted:ao,unmounted:so},ze=Symbol.for("vuetify:v-window"),Fe=Symbol.for("vuetify:v-window-group"),Ze=Z({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||e==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Ee(),...Pe(),...Qe()},"VWindow"),ge=K()({name:"VWindow",directives:{Touch:Ne},props:Ze(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const{themeClasses:n}=et(e),{isRtl:a}=tt(),{t:s}=ot(),l=nt(e,Fe),f=W(),y=c(()=>a.value?!e.reverse:e.reverse),d=ye(!1),k=c(()=>{const m=e.direction==="vertical"?"y":"x",$=(y.value?!d.value:d.value)?"-reverse":"";return`v-window-${m}${$}-transition`}),x=ye(0),p=W(void 0),V=c(()=>l.items.value.findIndex(m=>l.selected.value.includes(m.id)));Ae(V,(m,g)=>{const $=l.items.value.length,S=$-1;$<=2?d.value=m<g:m===S&&g===0?d.value=!0:m===0&&g===S?d.value=!1:d.value=m<g}),at(ze,{transition:k,isReversed:d,transitionCount:x,transitionHeight:p,rootRef:f});const _=c(()=>e.continuous||V.value!==0),T=c(()=>e.continuous||V.value!==l.items.value.length-1);function O(){_.value&&l.prev()}function H(){T.value&&l.next()}const E=c(()=>{const m=[],g={icon:a.value?e.nextIcon:e.prevIcon,class:`v-window__${y.value?"right":"left"}`,onClick:l.prev,"aria-label":s("$vuetify.carousel.prev")};m.push(_.value?o.prev?o.prev({props:g}):r(A,g,null):r("div",null,null));const $={icon:a.value?e.prevIcon:e.nextIcon,class:`v-window__${y.value?"left":"right"}`,onClick:l.next,"aria-label":s("$vuetify.carousel.next")};return m.push(T.value?o.next?o.next({props:$}):r(A,$,null):r("div",null,null)),m}),b=c(()=>e.touch===!1?e.touch:{...{left:()=>{y.value?O():H()},right:()=>{y.value?H():O()},start:g=>{let{originalEvent:$}=g;$.stopPropagation()}},...e.touch===!0?{}:e.touch});return q(()=>We(r(e.tag,{ref:f,class:["v-window",{"v-window--show-arrows-on-hover":e.showArrows==="hover"},n.value,e.class],style:e.style},{default:()=>{var m,g;return[r("div",{class:"v-window__container",style:{height:p.value}},[(m=o.default)==null?void 0:m.call(o,{group:l}),e.showArrows!==!1&&r("div",{class:"v-window__controls"},[E.value])]),(g=o.additional)==null?void 0:g.call(o,{group:l})]}}),[[st("touch"),b.value]])),{group:l}}}),Ke=Z({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Ee(),...lt(),...Ht()},"VWindowItem"),te=K()({name:"VWindowItem",directives:{Touch:Ne},props:Ke(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:o}=t;const n=Oe(ze),a=it(e,Fe),{isBooted:s}=ut();if(!n||!a)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const l=ye(!1),f=c(()=>s.value&&(n.isReversed.value?e.reverseTransition!==!1:e.transition!==!1));function y(){!l.value||!n||(l.value=!1,n.transitionCount.value>0&&(n.transitionCount.value-=1,n.transitionCount.value===0&&(n.transitionHeight.value=void 0)))}function d(){var _;l.value||!n||(l.value=!0,n.transitionCount.value===0&&(n.transitionHeight.value=pe((_=n.rootRef.value)==null?void 0:_.clientHeight)),n.transitionCount.value+=1)}function k(){y()}function x(_){l.value&&dt(()=>{!f.value||!l.value||!n||(n.transitionHeight.value=pe(_.clientHeight))})}const p=c(()=>{const _=n.isReversed.value?e.reverseTransition:e.transition;return f.value?{name:typeof _!="string"?n.transition.value:_,onBeforeEnter:d,onAfterEnter:y,onEnterCancelled:k,onBeforeLeave:d,onAfterLeave:y,onLeaveCancelled:k,onEnter:x}:!1}),{hasContent:V}=jt(e,a.isSelected);return q(()=>r(ct,{transition:p.value,disabled:!s.value},{default:()=>{var _;return[We(r("div",{class:["v-window-item",a.selectedClass.value,e.class],style:e.style},[V.value&&((_=o.default)==null?void 0:_.call(o))]),[[rt,a.isSelected.value]])]}})),{groupItem:a}}}),ke=Symbol.for("vuetify:v-tabs"),lo=Z({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...De(vt({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),re=K()({name:"VTab",props:lo(),setup(e,t){let{slots:o,attrs:n}=t;const{textColorClasses:a,textColorStyles:s}=ft(e,"sliderColor"),l=W(),f=W(),y=c(()=>e.direction==="horizontal"),d=c(()=>{var x,p;return((p=(x=l.value)==null?void 0:x.group)==null?void 0:p.isSelected.value)??!1});function k(x){var V,_;let{value:p}=x;if(p){const T=(_=(V=l.value)==null?void 0:V.$el.parentElement)==null?void 0:_.querySelector(".v-tab--selected .v-tab__slider"),O=f.value;if(!T||!O)return;const H=getComputedStyle(T).color,E=T.getBoundingClientRect(),b=O.getBoundingClientRect(),m=y.value?"x":"y",g=y.value?"X":"Y",$=y.value?"right":"bottom",S=y.value?"width":"height",J=E[m],de=b[m],D=J>de?E[$]-b[$]:E[m]-b[m],ve=Math.sign(D)>0?y.value?"right":"bottom":Math.sign(D)<0?y.value?"left":"top":"center",fe=(Math.abs(D)+(Math.sign(D)<0?E[S]:b[S]))/Math.max(E[S],b[S])||0,Q=E[S]/b[S]||0,se=1.5;Ft(O,{backgroundColor:[H,"currentcolor"],transform:[`translate${g}(${D}px) scale${g}(${Q})`,`translate${g}(${D/se}px) scale${g}(${(fe-1)/se+1})`,"none"],transformOrigin:Array(3).fill(ve)},{duration:225,easing:Zt})}}return q(()=>{const x=A.filterProps(e);return r(A,F({symbol:ke,ref:l,class:["v-tab",e.class],style:e.style,tabindex:d.value?0:-1,role:"tab","aria-selected":String(d.value),active:!1},x,n,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":k}),{...o,default:()=>{var p;return r(j,null,[((p=o.default)==null?void 0:p.call(o))??e.text,!e.hideSlider&&r("div",{ref:f,class:["v-tab__slider",a.value],style:s.value},null)])}})}),zt({},l)}}),io=Z({...De(Ze(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),uo=K()({name:"VTabsWindow",props:io(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:o}=t;const n=Oe(ke,null),a=Le(e,"modelValue"),s=c({get(){var l;return a.value!=null||!n?a.value:(l=n.items.value.find(f=>n.selected.value.includes(f.id)))==null?void 0:l.value},set(l){a.value=l}});return q(()=>{const l=ge.filterProps(e);return r(ge,F({_as:"VTabsWindow"},l,{modelValue:s.value,"onUpdate:modelValue":f=>s.value=f,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),o)}),{}}}),ro=Z({...Ke()},"VTabsWindowItem"),co=K()({name:"VTabsWindowItem",props:ro(),setup(e,t){let{slots:o}=t;return q(()=>{const n=te.filterProps(e);return r(te,F({_as:"VTabsWindowItem"},n,{class:["v-tabs-window-item",e.class],style:e.style}),o)}),{}}});function vo(e){return e?e.map(t=>kt(t)?t:{text:t,value:t}):[]}const fo=Z({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Xt({mandatory:"force",selectedClass:"v-tab-item--selected"}),...mt(),...Pe()},"VTabs"),mo=K()({name:"VTabs",props:fo(),emits:{"update:modelValue":e=>!0},setup(e,t){let{attrs:o,slots:n}=t;const a=Le(e,"modelValue"),s=c(()=>vo(e.items)),{densityClasses:l}=ht(e),{backgroundColorClasses:f,backgroundColorStyles:y}=yt(X(e,"bgColor")),{scopeId:d}=pt();return gt({VTab:{color:X(e,"color"),direction:X(e,"direction"),stacked:X(e,"stacked"),fixed:X(e,"fixedTabs"),sliderColor:X(e,"sliderColor"),hideSlider:X(e,"hideSlider")}}),q(()=>{const k=Ie.filterProps(e),x=!!(n.window||e.items.length>0);return r(j,null,[r(Ie,F(k,{modelValue:a.value,"onUpdate:modelValue":p=>a.value=p,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},l.value,f.value,e.class],style:[{"--v-tabs-height":pe(e.height)},y.value,e.style],role:"tablist",symbol:ke},d,o),{default:()=>{var p;return[((p=n.default)==null?void 0:p.call(n))??s.value.map(V=>{var _;return((_=n.tab)==null?void 0:_.call(n,{item:V}))??r(re,F(V,{key:V.text,value:V.value}),{default:n[`tab.${V.value}`]?()=>{var T;return(T=n[`tab.${V.value}`])==null?void 0:T.call(n,{item:V})}:void 0})})]}}),x&&r(uo,F({modelValue:a.value,"onUpdate:modelValue":p=>a.value=p,key:"tabs-window"},d),{default:()=>{var p;return[s.value.map(V=>{var _;return((_=n.item)==null?void 0:_.call(n,{item:V}))??r(co,{value:V.value},{default:()=>{var T;return(T=n[`item.${V.value}`])==null?void 0:T.call(n,{item:V})}})}),(p=n.window)==null?void 0:p.call(n)]}})])}),{}}});function ho(e,t){const o=W();return z(e,"dragstart",n=>{if(o.value=n.target,typeof t=="string"){const a=t;t=(s,l)=>{l==null||l.setData("text/plain",s.dataset[a]??"")}}t==null||t(o.value,n.dataTransfer)}),z(e,"dragend",()=>{o.value=null}),{element:o}}function qe(e,t,o=!0){const n=W(!1);let a=0;return Bt&&(z(e,"dragenter",s=>{s.preventDefault(),a++,n.value=!0}),z(e,"dragover",s=>{s.preventDefault()}),z(e,"dragleave",s=>{s.preventDefault(),a--,a===0&&(n.value=!1)}),z(e,"drop",s=>{var l;if(s.preventDefault(),a=0,n.value=!1,t)if(o){const f=Array.from(((l=s.dataTransfer)==null?void 0:l.files)??[]);t(f.length===0?null:f)}else t(s.dataTransfer)})),{isOverDropZone:n}}const yo={class:"d-inline-block"},po={class:"text-white overflow-hidden"},go={class:"title inline-block relative"},ko=["innerHTML"],bo={key:1},_o=["innerHTML"],wo={key:0},Vo={key:1},$o={key:2},Co={key:3},xo={class:"table-fixed"},To={class:"w-1/3"},So={class:"text-center"},Io=["title"],Bo={class:"text-center"},Ro=["title"],Mo={class:"text-center"},Eo=["title"],Po={class:"text-center"},Ao=["title"],Wo={class:"text-center"},Oo=["title"],Do={class:"text-right"},Lo={class:"text-right"},Uo={class:"text-right"},Ho={class:"text-right"},jo={class:"text-right"},Xo={class:"text-right"},Yo={class:"text-right"},Go={class:"text-right"},No={class:"text-right"},zo={class:"text-right"},Fo=ne({__name:"Ticket",props:{ticket:{}},setup(e){bt(u=>({"089ed14c":Ve.value.delay,fb3395aa:Ve.value.duration}));const t=e,{t:o}=_t(),n=c(()=>Se().props.factors),a=W(null),s=new Rt({linkify:!0}).use(Mt),l=Xe(),f=Ye(),y=c(()=>Se().props.options),d=c(()=>ee(t.ticket.created_at)),k=c(()=>ee.duration(t.ticket.delay,"s")),x=c(()=>d.value.add(k.value)),p=c(()=>t.ticket.bound_at?ee(t.ticket.bound_at):null),V=c(()=>t.ticket.reservation?ee.duration(t.ticket.reservation,"s"):null),_=c(()=>p.value&&V.value?p.value.add(V.value):null),T=c(()=>t.ticket.accepted_at?ee(t.ticket.accepted_at):null),O=c(()=>`${d.value.format("lll")} (${d.value.fromNow()})`),H=c(()=>`${x.value.format("lll")} (${o("time_left",{time:x.value.fromNow(!0)})})`),E=c(()=>p.value?`${p.value.format("lll")} (${p.value.fromNow()})`:null),b=c(()=>_.value?`${_.value.format("lll")} (${o("time_left",{time:_.value.fromNow(!0)})})`:null),m=c(()=>T.value?`${T.value.format("lll")} (${T.value.fromNow()})`:null),g=c(()=>`${J(t.ticket.weight)} (${o("increment_per_second",{units:t.ticket.weight_increment.toString()})})`),$=c(()=>y.value[`${f.value}_threshold`]),S=c(()=>t.ticket[f.value]),J=u=>u<1e5?u:u.toExponential(1),de=()=>{var u,R;return((u=t.ticket.meta)==null?void 0:u.category_name)??((R=t.ticket.category)==null?void 0:R.name)??""},D=()=>{var u,R;return((u=t.ticket.meta)==null?void 0:u.category_short)??((R=t.ticket.category)==null?void 0:R.short)??""},ve=()=>{var u;return l.altInfo?((u=t.ticket.meta)==null?void 0:u.title)??D():D()},we=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_title)??"Title"}),fe=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_subtitle)??de()}),Q=c(()=>{var u;return((u=t.ticket.meta)==null?void 0:u.card_content)??[]}),se=c(()=>S.value>$.value),Ve=c(()=>({delay:-S.value+"s",duration:$.value+"s"}));return(u,R)=>(w(),I("div",yo,[r(A,{size:"small",class:ce(["ticket justify-start px-2",{overflow:se.value}]),ripple:!1,flat:"",width:"100"},{default:h(()=>{var $e,Ce;return[($e=u.ticket.meta)!=null&&$e.icon?(w(),M(Ue,{key:0,icon:((Ce=u.ticket.meta)==null?void 0:Ce.icon)??"",color:"white"},null,8,["icon"])):Y("",!0),i("span",po,[i("span",go,v(ve()),1)]),r(Yt,{"open-on-click":"",activator:"parent","location-strategy":"connected",location:"bottom center",origin:"auto"},{default:h(()=>{var xe;return[r(Gt,{width:"500","prepend-icon":((xe=u.ticket.meta)==null?void 0:xe.icon)??"",title:we.value,subtitle:fe.value},{default:h(()=>[r(mo,{modelValue:a.value,"onUpdate:modelValue":R[0]||(R[0]=P=>a.value=P)},{default:h(()=>[r(re,{value:"properties"},{default:h(()=>[B(v(u.$t("properties")),1)]),_:1}),r(re,{value:"metrics"},{default:h(()=>[B(v(u.$t("metrics")),1)]),_:1}),r(re,{value:"details"},{default:h(()=>[B(v(u.$t("details")),1)]),_:1})]),_:1},8,["modelValue"]),r(Nt,null,{default:h(()=>[r(ge,{modelValue:a.value,"onUpdate:modelValue":R[1]||(R[1]=P=>a.value=P)},{default:h(()=>[r(te,{value:"properties",class:"prose"},{default:h(()=>[typeof Q.value=="string"?(w(),I("div",{key:0,innerHTML:C(s).render(Q.value)},null,8,ko)):(w(),I("table",bo,[i("tbody",null,[(w(!0),I(j,null,oe(Q.value,([P,le])=>(w(),I("tr",{key:P},[i("th",null,v(P),1),i("td",{innerHTML:C(s).renderInline(le)},null,8,_o)]))),128))])]))]),_:1}),r(te,{value:"metrics",class:"prose"},{default:h(()=>[i("table",null,[i("tbody",null,[i("tr",null,[i("th",null,v(u.$t("issued_on")),1),i("td",null,v(O.value),1)]),x.value.isAfter(u.$dayjs())?(w(),I("tr",wo,[i("th",null,v(u.$t("delayed_until")),1),i("td",null,v(H.value),1)])):Y("",!0),p.value?(w(),I("tr",Vo,[i("th",null,v(u.$t("bound_at")),1),i("td",null,v(E.value),1)])):Y("",!0),_.value&&_.value.isAfter(u.$dayjs())?(w(),I("tr",$o,[i("th",null,v(u.$t("reserved_until")),1),i("td",null,v(b.value),1)])):Y("",!0),T.value?(w(),I("tr",Co,[i("th",null,v(u.$t("accepted_at")),1),i("td",null,v(m.value),1)])):Y("",!0),i("tr",null,[i("th",null,v(u.$t("current_weight")),1),i("td",null,v(g.value),1)]),i("tr",null,[i("th",null,v(u.$t("complexity")),1),i("td",null,v(u.ticket.complexity+" "+C(o)("units")),1)])])])]),_:1}),r(te,{value:"details",class:"prose"},{default:h(()=>[i("table",xo,[i("thead",null,[i("tr",null,[i("th",To,v(u.$t("factor")),1),i("th",So,[i("em",{class:"metric",title:u.$t("initial_weight")},R[2]||(R[2]=[B("W"),i("sub",null,"0",-1)]),8,Io)]),i("th",Bo,[i("em",{class:"metric",title:u.$t("weight_increment")},R[3]||(R[3]=[B("W"),i("sub",null,"i",-1)]),8,Ro)]),i("th",Mo,[i("em",{class:"metric",title:u.$t("complexity")},"C",8,Eo)]),i("th",Po,[i("em",{class:"metric",title:u.$t("delay_sec")},"D",8,Ao)]),i("th",Wo,[i("em",{class:"metric",title:u.$t("reservation_sec")},"R",8,Oo)])])]),i("tbody",null,[(w(!0),I(j,null,oe(u.ticket.metrics??{},(P,le)=>{var Te;return w(),I("tr",{key:le},[i("th",null,v(((Te=n.value[le])==null?void 0:Te.name)??u.$t("unknown")),1),i("td",Do,v(P.initial_weight??0),1),i("td",Lo,v(P.weight_increment??0),1),i("td",Uo,v(P.complexity??0),1),i("td",Ho,v(P.delay??0),1),i("td",jo,v(P.reservation??0),1)])}),128))]),i("tfoot",null,[i("tr",null,[i("th",null,v(u.$t("total")),1),i("td",Xo,v(u.ticket.initial_weight),1),i("td",Yo,v(u.ticket.weight_increment),1),i("td",Go,v(u.ticket.complexity),1),i("td",No,v(u.ticket.delay),1),i("td",zo,v(u.ticket.reservation),1)])])])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["prepend-icon","title","subtitle"])]}),_:1})]}),_:1},8,["class"])]))}}),Zo=ae(Fo,[["__scopeId","data-v-59edf879"]]),Ko=ne({__name:"TicketPool",props:{tickets:{}},setup(e){const t=W(null);ho(t,"uuid");const{lock:o,unlock:n,element:a,triggerElement:s}=Et(t),{x:l}=Pt({type:"movement"});c(()=>ue(Ge)),Ae([a,l],([y,d])=>{!y||!s.value||s.value.dataset.uuid});const f=W(!1);return He(()=>{setTimeout(()=>f.value=!0,500)}),(y,d)=>(w(),M(C(Re),{ref_key:"ticketPool",ref:t,name:"ticket-pool",class:"@container tickets leading-8 !pt-[1px] !pb-[3px]",css:f.value,onMouseup:C(n)},{default:h(()=>[(w(!0),I(j,null,oe(y.tickets,k=>(w(),M(Zo,{key:k.uuid,"data-uuid":k.uuid,ticket:k,draggable:"true",class:"mr-1",onMousedown:wt(C(o),["ctrl"])},null,8,["data-uuid","ticket","onMousedown"]))),128))]),_:1},8,["css","onMouseup"]))}}),qo=ae(Ko,[["__scopeId","data-v-ba6baa0a"]]);function be(){async function e(a,s){return await window.axios.patch(ie("ticket-allocator.operators.ready",a),{ready:s})}async function t(a,s){return await window.axios.patch(ie("ticket-allocator.tickets.weight",a),{weight_points:s})}async function o(a,s){return await window.axios.patch(ie("ticket-allocator.tickets.handler",a),{operator_uuid:s??null})}async function n(a){return await window.axios.delete(ie("ticket-allocator.tickets.close",a))}return{ready:e,weight:t,handler:o,close:n}}const Jo=ne({__name:"TicketRow",props:{tickets:{},pool:{type:Boolean}},setup(e){const t=e;let o=W(!1);const n=c(()=>t.pool?"th":"td"),a=c(()=>t.tickets.reduce((d,{complexity:k})=>d+k,0)),s=c(()=>o.value?"mdi-chevron-down":"mdi-chevron-up"),l=be(),f=W(null),{isOverDropZone:y}=qe(f,async d=>{var p;const k=d==null?void 0:d.getData("text/plain");if(!k)throw new Error("Ticket UUID undefined.");const x=(p=f.value)==null?void 0:p.dataset.uuid;return await l.handler(k,x)},!1);return(d,k)=>(w(),I("tr",{ref_key:"ticketRow",ref:f,class:ce(["ticket-row",{dragover:C(y)}])},[(w(),M(N(n.value),{class:"status py-1"},{default:h(()=>[G(d.$slots,"status",{},void 0,!0)]),_:3})),(w(),M(N(n.value),{class:"name !pt-[6px] font-weight-bold"},{default:h(()=>[G(d.$slots,"name",{},void 0,!0)]),_:3})),(w(),M(N(n.value),{class:"load !pt-[6px] text-center"},{default:h(()=>[G(d.$slots,"load",{},()=>[B(v(d.tickets.length),1)],!0),k[2]||(k[2]=B("/")),G(d.$slots,"load-max",{},()=>[k[1]||(k[1]=B("∞"))],!0)]),_:3})),(w(),M(N(n.value),{class:"complexity !pt-[6px] text-center"},{default:h(()=>[G(d.$slots,"complexity",{},()=>[B(v(a.value),1)],!0),k[4]||(k[4]=B("/")),G(d.$slots,"complexity-max",{},()=>[k[3]||(k[3]=B("∞"))],!0)]),_:3})),r(qo,{tag:n.value,tickets:d.tickets,class:ce({collapsed:C(o)})},null,8,["tag","tickets","class"]),(w(),M(N(n.value),{class:"more !pt-[2px] text-center"},{default:h(()=>[r(A,{size:"x-small",variant:"tonal",icon:s.value,onClick:k[0]||(k[0]=x=>je(o)?o.value=!C(o):o=!C(o))},null,8,["icon"])]),_:1}))],2))}}),Je=ae(Jo,[["__scopeId","data-v-62b3ff4d"]]),Qo=ne({__name:"OperatorRow",props:{operator:{}},setup(e){const t=e,o=c(()=>{var s,l;return{online:t.operator.online,ready:t.operator.ready,busy:!!((s=t.operator.tickets)!=null&&s.length),full:t.operator.ticket_limit!==null&&((l=t.operator.tickets)==null?void 0:l.length)>=t.operator.ticket_limit}}),n=be(),a=async()=>await n.ready(t.operator.uuid,!t.operator.ready);return(s,l)=>(w(),M(Je,{tickets:s.operator.tickets,"data-uuid":s.operator.uuid,class:ce(["operator",o.value])},{status:h(()=>[r(Ue,{icon:"mdi-account",onClick:a})]),"load-max":h(()=>[B(v(s.operator.ticket_limit??"∞"),1)]),"complexity-max":h(()=>[B(v(s.operator.complexity_limit??"∞"),1)]),name:h(()=>[B(v(s.operator.name),1)]),_:1},8,["tickets","data-uuid","class"]))}}),en=ae(Qo,[["__scopeId","data-v-a776c74a"]]);function tn(e,t){return e.reduce((o,n)=>(typeof n[t]=="number"&&(o+=n[t]),o),0)}function _e(e,t){return e.map(o=>Vt(o,t)).filter(o=>o)}function on(e,t){const o=_e(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.max(...o)}function nn(e,t){const o=_e(e,t).filter(n=>typeof n=="number");return o.length===0?0:Math.min(...o)}function an(e){return e.map(t=>t[t.$getLocalKey()])}function sn(e,t){const o={},n=Array.isArray(t)?t:[t];return e.forEach(a=>{const s=n.length===1?a[n[0]]:`[${n.map(l=>a[l]).toString()}]`;o[s]=(o[s]||[]).concat(a)}),o}function ln(e,t,o){const n=[],a=[];return typeof t=="function"&&a.push(t)&&n.push("asc"),Array.isArray(t)&&t.forEach(s=>a.push(s[0])&&n.push(s[1])),a.length===0&&a.push(t),$t(e,a,n,o)}function un(e){return{sum:t=>tn(e,t),min:t=>nn(e,t),max:t=>on(e,t),pluck:t=>_e(e,t),groupBy:t=>sn(e,t),sortBy:(t,o="SORT_REGULAR")=>ln(e,t,o),keys:()=>an(e)}}const rn={class:"font-semibold text-xl text-gray-800 leading-tight"},cn={class:"align-top"},dn=ne({__name:"Dashboard",props:{layout:{default:"default"},operators:{},tickets:{},ticketCategories:{},factors:{},matchers:{}},setup(e){const t=e,o=Xe(),n=Ye(),a=c(()=>ue(Dt)),s=c(()=>ue(Ge)),l=c(()=>ue(Lt)),f=At(Ot),y=Ct({}),d=b=>Object.entries(y).reduce((m,[g,$])=>{const S=b==null?void 0:b[g],J=S===void 0||!$.length||$.map(String).includes(S.toString());return m&&J},!0),k=c(()=>un(a.value.with("tickets",b=>{b.with("category").where("meta",d).orderBy(n.value,"desc")}).whereHas("tickets").orWhere(b=>!o.hideEmpty&&b.online).get()).sortBy([["online","desc"],["ready","desc"],["free_slots","desc"],["ticket_count","asc"],["name","asc"]])),x=c(()=>s.value.unbound().with("category").where("meta",d).orderBy(n.value,"desc").get()),p=be(),V=W(null),{isOverDropZone:_}=qe(V,async b=>{const m=b==null?void 0:b.getData("text/plain");if(!m)throw new Error("Ticket UUID undefined.");return await p.close(m)},!1);He(()=>{f.listen(Wt.PropsInvalidated,()=>me.reload()).listen(L.Enrolled,a.value.enroll).listen(L.Resigned,a.value.resign).listen(L.NameChanged,a.value.changeName).listen(L.Online,a.value.setOnline).listen(L.Offline,a.value.setOffline).listen(L.Ready,a.value.setReady).listen(L.NotReady,a.value.setNotReady).listen(L.TicketLimitAdjusted,a.value.adjustTicketLimit).listen(L.ComplexityLimitAdjusted,a.value.adjustComplexityLimit).listen(U.Created,s.value.create).listen(U.Closed,s.value.close).listen(U.Bound,s.value.bind).listen(U.Accepted,s.value.accept).listen(U.Unbound,s.value.unbind).listen(U.CategoryChanged,s.value.changeCategory).listen(U.MetaValueSet,s.value.setMetaValue).listen(U.MetaValuesMerged,s.value.mergeMetaValues).listen(U.MetricsAdjusted,s.value.adjustMetrics)});function T(){a.value.fresh(t.operators),s.value.fresh(t.tickets),l.value.fresh(t.ticketCategories)}const O=me.on("navigate",T),H=me.on("success",T);xt(()=>{O(),H()});const E=b=>Object.entries(b).map(([m,g])=>({title:m,value:g}));return(b,m)=>(w(),I(j,null,[r(C(Tt),{title:b.$t("dashboard")},null,8,["title"]),(w(),M(N(`${b.layout}-layout`),null,{header:h(()=>[i("h2",rn,v(b.$t("dashboard")),1)]),default:h(()=>[i("div",null,[r(qt,{fluid:""},{default:h(()=>[r(Be,null,{default:h(()=>[r(he,null,{default:h(()=>[r(St,{modelValue:C(o).all,"onUpdate:modelValue":m[0]||(m[0]=g=>C(o).all=g),variant:"plain",multiple:""},{default:h(()=>[r(A,{value:"show-filters",icon:C(o).showFilters?"mdi-filter-outline":"mdi-filter-off-outline"},null,8,["icon"]),r(A,{value:"hide-empty",icon:C(o).hideEmpty?"mdi-eye-off-outline":"mdi-eye-outline"},null,8,["icon"]),r(A,{value:"alt-info",icon:C(o).altInfo?"mdi-magnify-plus-outline":"mdi-magnify"},null,8,["icon"]),r(A,{value:"unlocked",icon:C(o).unlocked?"mdi-lock-open-variant":"mdi-lock",color:"red",variant:C(o).unlocked?"text":"plain"},null,8,["icon","variant"])]),_:1},8,["modelValue"]),C(o).unlocked?(w(),M(It,{key:0,variant:"plain"},{default:h(()=>[r(A,{ref_key:"closeTicket",ref:V,icon:C(_)?"mdi-delete-empty":"mdi-delete"},null,8,["icon"]),r(A,{icon:"mdi-refresh"})]),_:1})):Y("",!0)]),_:1}),r(he,{cols:"2"},{default:h(()=>[r(Ut,{modelValue:C(n),"onUpdate:modelValue":m[1]||(m[1]=g=>je(n)?n.value=g:null),"false-value":"weight","true-value":"duration","prepend-icon":"mdi-weight","append-icon":"mdi-clock",class:"d-flex justify-end"},null,8,["modelValue"])]),_:1})]),_:1}),C(o).showFilters?(w(),M(Be,{key:0},{default:h(()=>[(w(!0),I(j,null,oe(b.matchers,(g,$)=>(w(),M(he,{key:$,cols:"2"},{default:h(()=>[r(Kt,{modelValue:y[$],"onUpdate:modelValue":S=>y[$]=S,multiple:"",clearable:"",chips:"","closable-chips":"",label:b.$t($),items:E(g)},null,8,["modelValue","onUpdate:modelValue","label","items"])]),_:2},1024))),128))]),_:1})):Y("",!0)]),_:1}),r(Jt,{"fixed-header":"",height:"600px",density:"compact",class:"ticket-monitor"},{default:h(()=>[i("thead",cn,[r(Je,{pool:"",tickets:x.value},{name:h(()=>[B(v(b.$t("ticket_pool")),1)]),_:1},8,["tickets"])]),r(C(Re),{tag:"tbody",class:"align-top",name:"operator-pool"},{default:h(()=>[(w(!0),I(j,null,oe(k.value,g=>(w(),M(en,{key:g.uuid,operator:g},null,8,["operator"]))),128))]),_:1})]),_:1})])]),_:1}))],64))}}),xn=ae(dn,[["__scopeId","data-v-ebc3bf45"]]);export{xn as default};
//# sourceMappingURL=Dashboard-KYcfvq1A.js.map
