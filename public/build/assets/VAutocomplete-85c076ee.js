import{t as te,bm as ue,bn as ne,aa as oe,bo as se,bp as ie,am as ce,r as V,ah as L,c as C,bq as re,ac as ve,br as de,bs as fe,w as N,n as O,l as me,b6 as B,m as s,aJ as z,bt as pe,ae as I,bu as he,bv as K,ba as ye,bw as ge,x as ke,aH as Ve,bk as Ce,bx as be}from"./app-5c0efa71.js";function we(l,f,a){if(f==null)return l;if(Array.isArray(f))throw new Error("Multiple matches is not implemented");return typeof f=="number"&&~f?s(z,null,[s("span",{class:"v-autocomplete__unmask"},[l.substr(0,f)]),s("span",{class:"v-autocomplete__mask"},[l.substr(f,a)]),s("span",{class:"v-autocomplete__unmask"},[l.substr(f+a)])]):l}const _e=te()({name:"VAutocomplete",props:{search:String,...ue({filterKeys:["title"]}),...ne(),...oe(se({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...ie({transition:!1})},emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,f){let{slots:a}=f;const{t:H}=ce(),y=V(),g=V(!1),p=V(!0),E=V(),D=L(l,"menu"),r=C({get:()=>D.value,set:e=>{var t;D.value&&!e&&((t=E.value)!=null&&t.Î¨openChildren)||(D.value=e)}}),o=V(-1),$=C(()=>{var e;return(e=y.value)==null?void 0:e.color}),{items:F,transformIn:q,transformOut:J}=re(l),{textColorClasses:j,textColorStyles:G}=ve($),i=L(l,"search",""),m=L(l,"modelValue",[],e=>q(be(e)),e=>{const t=J(e);return l.multiple?t:t[0]??null}),b=de(),{filteredItems:P,getMatches:Q}=fe(l,F,C(()=>p.value?void 0:i.value)),h=C(()=>m.value.map(e=>F.value.find(t=>l.valueComparator(t.value,e.value))||e)),R=C(()=>l.hideSelected?P.value.filter(e=>!h.value.some(t=>t.value===e.value)):P.value),T=C(()=>h.value.map(e=>e.props.value)),U=C(()=>h.value[o.value]),M=V();function W(e){l.openOnClear&&(r.value=!0),i.value=""}function X(){l.hideNoData&&!F.value.length||l.readonly||b!=null&&b.isReadonly.value||(r.value=!0)}function Y(e){var A,u,v,k;if(l.readonly||b!=null&&b.isReadonly.value)return;const t=y.value.selectionStart,c=T.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(e.key))&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),["Enter","Escape","Tab"].includes(e.key)&&(p.value=!0),e.key==="ArrowDown"?(A=M.value)==null||A.focus("next"):e.key==="ArrowUp"&&((u=M.value)==null||u.focus("prev")),!!l.multiple){if(["Backspace","Delete"].includes(e.key)){if(o.value<0){e.key==="Backspace"&&!i.value&&(o.value=c-1);return}const n=o.value;U.value&&x(U.value),o.value=n>=c-1?c-2:n}if(e.key==="ArrowLeft"){if(o.value<0&&t>0)return;const n=o.value>-1?o.value-1:c-1;h.value[n]?o.value=n:(o.value=-1,y.value.setSelectionRange((v=i.value)==null?void 0:v.length,(k=i.value)==null?void 0:k.length))}if(e.key==="ArrowRight"){if(o.value<0)return;const n=o.value+1;h.value[n]?o.value=n:(o.value=-1,y.value.setSelectionRange(0,0))}}}function Z(e){i.value=e.target.value}function ee(){g.value&&(p.value=!0)}function le(e){g.value=!0}function ae(e){var t;e.relatedTarget==null&&((t=y.value)==null||t.focus())}const w=V(!1);function x(e){if(l.multiple){const t=T.value.findIndex(c=>l.valueComparator(c,e.value));if(t===-1)m.value=[...m.value,e];else{const c=[...m.value];c.splice(t,1),m.value=c}}else m.value=[e],w.value=!0,a.selection||(i.value=e.title),r.value=!1,p.value=!0,O(()=>w.value=!1)}return N(g,e=>{var t;e?(w.value=!0,i.value=l.multiple||a.selection?"":String(((t=h.value.at(-1))==null?void 0:t.props.title)??""),p.value=!0,O(()=>w.value=!1)):(r.value=!1,i.value="")}),N(i,e=>{!g.value||w.value||(e&&(r.value=!0),p.value=!e)}),me(()=>{const e=!!(l.chips||a.chip),t=!!(!l.hideNoData||R.value.length||a.prepend||a.append||a["no-data"]),c=m.value.length>0,[A]=B.filterProps(l);return s(B,I({ref:y},A,{modelValue:i.value,"onUpdate:modelValue":u=>{u==null&&(m.value=[])},focused:g.value,"onUpdate:focused":u=>g.value=u,validationValue:m.externalValue,dirty:c,onInput:Z,class:["v-autocomplete",{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selecting-index":o.value>-1,[`v-autocomplete--${l.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!a.selection}],appendInnerIcon:l.menuIcon,readonly:l.readonly,placeholder:c?void 0:l.placeholder,"onClick:clear":W,"onMousedown:control":X,onKeydown:Y}),{...a,default:()=>s(z,null,[s(pe,I({ref:E,modelValue:r.value,"onUpdate:modelValue":u=>r.value=u,activator:"parent",contentClass:"v-autocomplete__content",eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterLeave:ee},l.menuProps),{default:()=>[t&&s(he,{ref:M,selected:T.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onFocusin:le,onFocusout:ae},{default:()=>{var u,v,k;return[!R.value.length&&!l.hideNoData&&(((u=a["no-data"])==null?void 0:u.call(a))??s(K,{title:H(l.noDataText)},null)),(v=a["prepend-item"])==null?void 0:v.call(a),R.value.map(n=>{var _;return((_=a.item)==null?void 0:_.call(a,{item:n,props:I(n.props,{onClick:()=>x(n)})}))??s(K,I({key:n.value},n.props,{onClick:()=>x(n)}),{prepend:d=>{let{isSelected:S}=d;return l.multiple&&!l.hideSelected?s(ye,{modelValue:S,ripple:!1,tabindex:"-1"},null):void 0},title:()=>{var d,S;return p.value?n.title:we(n.title,(d=Q(n))==null?void 0:d.title,((S=i.value)==null?void 0:S.length)??0)}})}),(k=a["append-item"])==null?void 0:k.call(a)]}})]}),h.value.map((u,v)=>{var _;function k(d){d.stopPropagation(),d.preventDefault(),x(u)}const n={"onClick:close":k,modelValue:!0,"onUpdate:modelValue":void 0};return s("div",{key:u.value,class:["v-autocomplete__selection",v===o.value&&["v-autocomplete__selection--selected",j.value]],style:v===o.value?G.value:{}},[e?a.chip?s(ke,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:u.title}}},{default:()=>{var d;return[(d=a.chip)==null?void 0:d.call(a,{item:u,index:v,props:n})]}}):s(ge,I({key:"chip",closable:l.closableChips,size:"small",text:u.title},n),null):((_=a.selection)==null?void 0:_.call(a,{item:u,index:v}))??s("span",{class:"v-autocomplete__selection-text"},[u.title,l.multiple&&v<h.value.length-1&&s("span",{class:"v-autocomplete__selection-comma"},[Ve(",")])])])})])})}),Ce({isFocused:g,isPristine:p,menu:r,search:i,filteredItems:P,select:x},y)}});export{_e as V};
//# sourceMappingURL=VAutocomplete-85c076ee.js.map
