import{q as te,bq as ne,br as ue,F as oe,bs as se,bt as ie,Y as ce,r as V,O as L,c as C,bu as re,H as ve,bv as de,bw as fe,w as N,n as O,A as pe,aM as K,B as s,ak as U,bx as me,K as A,by as he,bz as z,aX as ye,C as ge,bA as ke,aU as Ve,aj as Ce,aV as be,bB as we}from"./app-c6b3c480.js";function xe(e,p,a){if(p==null)return e;if(Array.isArray(p))throw new Error("Multiple matches is not implemented");return typeof p=="number"&&~p?s(U,null,[s("span",{class:"v-autocomplete__unmask"},[e.substr(0,p)]),s("span",{class:"v-autocomplete__mask"},[e.substr(p,a)]),s("span",{class:"v-autocomplete__unmask"},[e.substr(p+a)])]):e}const Ae=te()({name:"VAutocomplete",props:{search:String,...ne({filterKeys:["title"]}),...ue(),...oe(se({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...ie({transition:!1})},emits:{"update:focused":e=>!0,"update:search":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,p){let{slots:a}=p;const{t:q}=ce(),y=V(),g=V(!1),m=V(!0),E=V(),F=L(e,"menu"),v=C({get:()=>F.value,set:l=>{var n;F.value&&!l&&((n=E.value)!=null&&n.Î¨openChildren)||(F.value=l)}}),o=V(-1),H=C(()=>{var l;return(l=y.value)==null?void 0:l.color}),{items:P,transformIn:$,transformOut:j}=re(e),{textColorClasses:X,textColorStyles:Y}=ve(H),i=L(e,"search",""),f=L(e,"modelValue",[],l=>$(we(l)),l=>{const n=j(l);return e.multiple?n:n[0]??null}),b=de(),{filteredItems:S,getMatches:G}=fe(e,P,C(()=>m.value?void 0:i.value)),h=C(()=>f.value.map(l=>P.value.find(n=>e.valueComparator(n.value,l.value))||l)),R=C(()=>e.hideSelected?S.value.filter(l=>!h.value.some(n=>n.value===l.value)):S.value),M=C(()=>h.value.map(l=>l.props.value)),B=C(()=>h.value[o.value]),T=V();function J(l){e.openOnClear&&(v.value=!0),i.value=""}function Q(){e.hideNoData&&!P.value.length||e.readonly||b!=null&&b.isReadonly.value||(v.value=!0)}function W(l){var _,u,d,k;if(e.readonly||b!=null&&b.isReadonly.value)return;const n=y.value.selectionStart,r=M.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(l.key))&&l.preventDefault(),["Enter","ArrowDown"].includes(l.key)&&(v.value=!0),["Escape"].includes(l.key)&&(v.value=!1),["Enter","Escape","Tab"].includes(l.key)&&(m.value=!0),l.key==="ArrowDown"?(_=T.value)==null||_.focus("next"):l.key==="ArrowUp"&&((u=T.value)==null||u.focus("prev")),!!e.multiple){if(["Backspace","Delete"].includes(l.key)){if(o.value<0){l.key==="Backspace"&&!i.value&&(o.value=r-1);return}const t=o.value;B.value&&x(B.value),o.value=t>=r-1?r-2:t}if(l.key==="ArrowLeft"){if(o.value<0&&n>0)return;const t=o.value>-1?o.value-1:r-1;h.value[t]?o.value=t:(o.value=-1,y.value.setSelectionRange((d=i.value)==null?void 0:d.length,(k=i.value)==null?void 0:k.length))}if(l.key==="ArrowRight"){if(o.value<0)return;const t=o.value+1;h.value[t]?o.value=t:(o.value=-1,y.value.setSelectionRange(0,0))}}}function Z(l){i.value=l.target.value}function ee(){g.value&&(m.value=!0)}function le(l){g.value=!0}function ae(l){var n;l.relatedTarget==null&&((n=y.value)==null||n.focus())}const w=V(!1);function x(l){if(e.multiple){const n=M.value.findIndex(r=>e.valueComparator(r,l.value));if(n===-1)f.value=[...f.value,l];else{const r=[...f.value];r.splice(n,1),f.value=r}}else f.value=[l],w.value=!0,a.selection||(i.value=l.title),v.value=!1,m.value=!0,O(()=>w.value=!1)}return N(g,l=>{var n;l?(w.value=!0,i.value=e.multiple||a.selection?"":String(((n=h.value.at(-1))==null?void 0:n.props.title)??""),m.value=!0,O(()=>w.value=!1)):(!e.multiple&&!i.value&&(f.value=[]),v.value=!1,i.value="")}),N(i,l=>{!g.value||w.value||(l&&(v.value=!0),m.value=!l)}),pe(()=>{const l=!!(e.chips||a.chip),n=!!(!e.hideNoData||R.value.length||a.prepend||a.append||a["no-data"]),r=f.value.length>0,[_]=K.filterProps(e);return s(K,A({ref:y},_,{modelValue:i.value,"onUpdate:modelValue":u=>{u==null&&(f.value=[])},focused:g.value,"onUpdate:focused":u=>g.value=u,validationValue:f.externalValue,dirty:r,onInput:Z,class:["v-autocomplete",{"v-autocomplete--active-menu":v.value,"v-autocomplete--chips":!!e.chips,"v-autocomplete--selecting-index":o.value>-1,[`v-autocomplete--${e.multiple?"multiple":"single"}`]:!0,"v-autocomplete--selection-slot":!!a.selection},e.class],style:e.style,appendInnerIcon:e.menuIcon,readonly:e.readonly,placeholder:r?void 0:e.placeholder,"onClick:clear":J,"onMousedown:control":Q,onKeydown:W}),{...a,default:()=>s(U,null,[s(me,A({ref:E,modelValue:v.value,"onUpdate:modelValue":u=>v.value=u,activator:"parent",contentClass:"v-autocomplete__content",eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ee},e.menuProps),{default:()=>[n&&s(he,{ref:T,selected:M.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onFocusin:le,onFocusout:ae},{default:()=>{var u,d,k;return[!R.value.length&&!e.hideNoData&&(((u=a["no-data"])==null?void 0:u.call(a))??s(z,{title:q(e.noDataText)},null)),(d=a["prepend-item"])==null?void 0:d.call(a),R.value.map(t=>{var I;return((I=a.item)==null?void 0:I.call(a,{item:t,props:A(t.props,{onClick:()=>x(t)})}))??s(z,A({key:t.value},t.props,{onClick:()=>x(t)}),{prepend:c=>{let{isSelected:D}=c;return s(U,null,[e.multiple&&!e.hideSelected?s(ye,{modelValue:D,ripple:!1,tabindex:"-1"},null):void 0,t.props.prependIcon&&s(ge,{icon:t.props.prependIcon},null)])},title:()=>{var c,D;return m.value?t.title:xe(t.title,(c=G(t))==null?void 0:c.title,((D=i.value)==null?void 0:D.length)??0)}})}),(k=a["append-item"])==null?void 0:k.call(a)]}})]}),h.value.map((u,d)=>{var I;function k(c){c.stopPropagation(),c.preventDefault(),x(u)}const t={"onClick:close":k,onMousedown(c){c.preventDefault(),c.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return s("div",{key:u.value,class:["v-autocomplete__selection",d===o.value&&["v-autocomplete__selection--selected",X.value]],style:d===o.value?Y.value:{}},[l?a.chip?s(Ve,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:u.title}}},{default:()=>{var c;return[(c=a.chip)==null?void 0:c.call(a,{item:u,index:d,props:t})]}}):s(ke,A({key:"chip",closable:e.closableChips,size:"small",text:u.title},t),null):((I=a.selection)==null?void 0:I.call(a,{item:u,index:d}))??s("span",{class:"v-autocomplete__selection-text"},[u.title,e.multiple&&d<h.value.length-1&&s("span",{class:"v-autocomplete__selection-comma"},[Ce(",")])])])})])})}),be({isFocused:g,isPristine:m,menu:v,search:i,filteredItems:S,select:x},y)}});export{Ae as V};
//# sourceMappingURL=VAutocomplete-b858a205.js.map
