import{p as we,bw as Ce,bx as ke,$ as xe,by as Se,bz as Fe,g as Ie,d as Ae,r as M,s as I,O as z,f as b,bA as Pe,a1 as Re,bB as De,bC as _e,bD as J,bE as Me,w as H,B as Y,F as Te,j as Le,aS as Q,i as o,X as L,bF as Be,W as T,bG as Ee,bH as Z,bI as Oe,b1 as Ke,H as ee,bJ as Ne,aX as Ue,az as ze,bK as He,aY as $e,bL as le,bM as je}from"./app-2b2def3a.js";function We(l,g,t){if(g==null)return l;if(Array.isArray(g))throw new Error("Multiple matches is not implemented");return typeof g=="number"&&~g?o(L,null,[o("span",{class:"v-autocomplete__unmask"},[l.substr(0,g)]),o("span",{class:"v-autocomplete__mask"},[l.substr(g,t)]),o("span",{class:"v-autocomplete__unmask"},[l.substr(g+t)])]):l}const Xe=we({autoSelectFirst:{type:[Boolean,String]},search:String,...Ce({filterKeys:["title"]}),...ke(),...xe(Se({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...Fe({transition:!1})},"VAutocomplete"),Ge=Ie()({name:"VAutocomplete",props:Xe(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,g){let{slots:t}=g;const{t:B}=Ae(),p=M(),w=I(!1),C=I(!0),A=I(!1),$=M(),j=M(),E=z(l,"menu"),r=b({get:()=>E.value,set:e=>{var a;E.value&&!e&&((a=$.value)!=null&&a.Î¨openChildren)||(E.value=e)}}),i=I(-1),te=b(()=>{var e;return(e=p.value)==null?void 0:e.color}),W=b(()=>r.value?l.closeText:l.openText),{items:P,transformIn:ae,transformOut:ue}=Pe(l),{textColorClasses:ne,textColorStyles:oe}=Re(te),c=z(l,"search",""),h=z(l,"modelValue",[],e=>ae(e===null?[null]:je(e)),e=>{const a=ue(e);return l.multiple?a:a[0]??null}),S=De(),{filteredItems:O,getMatches:ie}=_e(l,P,()=>C.value?"":c.value),m=b(()=>h.value.map(e=>P.value.find(a=>{const n=J(a.raw,l.itemValue),V=J(e.raw,l.itemValue);return n===void 0||V===void 0?!1:l.returnObject?l.valueComparator(n,V):l.valueComparator(a.value,e.value)})||e)),y=b(()=>l.hideSelected?O.value.filter(e=>!m.value.some(a=>a.value===e.value)):O.value),K=b(()=>m.value.map(e=>e.props.value)),X=b(()=>m.value[i.value]),R=b(()=>{var a;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&c.value===((a=y.value[0])==null?void 0:a.title))&&y.value.length>0&&!C.value&&!A.value}),N=b(()=>l.hideNoData&&!P.value.length||l.readonly||(S==null?void 0:S.isReadonly.value)),U=M(),{onListScroll:se,onListKeydown:re}=Me(U,p);function ce(e){l.openOnClear&&(r.value=!0),c.value=""}function ve(){N.value||(r.value=!0)}function de(e){N.value||(w.value&&(e.preventDefault(),e.stopPropagation()),r.value=!r.value)}function fe(e){var V,u,v;if(l.readonly||S!=null&&S.isReadonly.value)return;const a=p.value.selectionStart,n=K.value.length;if((i.value>-1||["Enter","ArrowDown","ArrowUp"].includes(e.key))&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(r.value=!0),["Escape"].includes(e.key)&&(r.value=!1),R.value&&["Enter","Tab"].includes(e.key)&&k(y.value[0]),e.key==="ArrowDown"&&R.value&&((V=U.value)==null||V.focus("next")),!!l.multiple){if(["Backspace","Delete"].includes(e.key)){if(i.value<0){e.key==="Backspace"&&!c.value&&(i.value=n-1);return}const s=i.value;X.value&&k(X.value),i.value=s>=n-1?n-2:s}if(e.key==="ArrowLeft"){if(i.value<0&&a>0)return;const s=i.value>-1?i.value-1:n-1;m.value[s]?i.value=s:(i.value=-1,p.value.setSelectionRange((u=c.value)==null?void 0:u.length,(v=c.value)==null?void 0:v.length))}if(e.key==="ArrowRight"){if(i.value<0)return;const s=i.value+1;m.value[s]?i.value=s:(i.value=-1,p.value.setSelectionRange(0,0))}}}function me(e){c.value=e.target.value}function pe(e){if(le(p.value,":autofill")||le(p.value,":-webkit-autofill")){const a=P.value.find(n=>n.title===e.target.value);a&&k(a)}}function he(){var e;w.value&&(C.value=!0,(e=p.value)==null||e.focus())}function ge(e){w.value=!0,setTimeout(()=>{A.value=!0})}function ye(e){A.value=!1}function Ve(e){(e==null||e===""&&!l.multiple)&&(h.value=[])}const F=I(!1);function k(e){if(l.multiple){const a=K.value.findIndex(n=>l.valueComparator(n,e.value));if(a===-1)h.value=[...h.value,e];else{const n=[...h.value];n.splice(a,1),h.value=n}}else h.value=[e],F.value=!0,c.value=e.title,r.value=!1,C.value=!0,Y(()=>F.value=!1)}return H(w,(e,a)=>{var n;e!==a&&(e?(F.value=!0,c.value=l.multiple?"":String(((n=m.value.at(-1))==null?void 0:n.props.title)??""),C.value=!0,Y(()=>F.value=!1)):(!l.multiple&&!c.value?h.value=[]:R.value&&!A.value&&!m.value.some(V=>{let{value:u}=V;return u===y.value[0].value})&&k(y.value[0]),r.value=!1,c.value="",i.value=-1))}),H(c,e=>{!w.value||F.value||(e&&(r.value=!0),C.value=!e)}),H(r,()=>{if(!l.hideSelected&&r.value&&m.value.length){const e=y.value.findIndex(a=>m.value.some(n=>a.value===n.value));Te&&window.requestAnimationFrame(()=>{var a;e>=0&&((a=j.value)==null||a.scrollToIndex(e))})}}),Le(()=>{const e=!!(l.chips||t.chip),a=!!(!l.hideNoData||y.value.length||t["prepend-item"]||t["append-item"]||t["no-data"]),n=h.value.length>0,[V]=Q.filterProps(l);return o(Q,T({ref:p},V,{modelValue:c.value,"onUpdate:modelValue":Ve,focused:w.value,"onUpdate:focused":u=>w.value=u,validationValue:h.externalValue,dirty:n,onInput:me,onChange:pe,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":r.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!t.selection,"v-autocomplete--selecting-index":i.value>-1},l.class],style:l.style,readonly:l.readonly,placeholder:n?void 0:l.placeholder,"onClick:clear":ce,"onMousedown:control":ve,onKeydown:fe}),{...t,default:()=>o(L,null,[o(Be,T({ref:$,modelValue:r.value,"onUpdate:modelValue":u=>r.value=u,activator:"parent",contentClass:"v-autocomplete__content",disabled:N.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterLeave:he},l.menuProps),{default:()=>[a&&o(Ee,{ref:U,selected:K.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:re,onFocusin:ge,onFocusout:ye,onScrollPassive:se,tabindex:"-1",color:l.itemColor??l.color},{default:()=>{var u,v,s;return[(u=t["prepend-item"])==null?void 0:u.call(t),!y.value.length&&!l.hideNoData&&(((v=t["no-data"])==null?void 0:v.call(t))??o(Z,{title:B(l.noDataText)},null)),o(Oe,{ref:j,renderless:!0,items:y.value},{default:x=>{var G;let{item:d,index:f,itemRef:be}=x;const q=T(d.props,{ref:be,key:f,active:R.value&&f===0?!0:void 0,onClick:()=>k(d)});return((G=t.item)==null?void 0:G.call(t,{item:d,index:f,props:q}))??o(Z,q,{prepend:D=>{let{isSelected:_}=D;return o(L,null,[l.multiple&&!l.hideSelected?o(Ke,{key:d.value,modelValue:_,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependIcon&&o(ee,{icon:d.props.prependIcon},null)])},title:()=>{var D,_;return C.value?d.title:We(d.title,(D=ie(d))==null?void 0:D.title,((_=c.value)==null?void 0:_.length)??0)}})}}),(s=t["append-item"])==null?void 0:s.call(t)]}})]}),m.value.map((u,v)=>{var d;function s(f){f.stopPropagation(),f.preventDefault(),k(u)}const x={"onClick:close":s,onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return o("div",{key:u.value,class:["v-autocomplete__selection",v===i.value&&["v-autocomplete__selection--selected",ne.value]],style:v===i.value?oe.value:{}},[e?t.chip?o(Ue,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:u.title}}},{default:()=>{var f;return[(f=t.chip)==null?void 0:f.call(t,{item:u,index:v,props:x})]}}):o(Ne,T({key:"chip",closable:l.closableChips,size:"small",text:u.title},x),null):((d=t.selection)==null?void 0:d.call(t,{item:u,index:v}))??o("span",{class:"v-autocomplete__selection-text"},[u.title,l.multiple&&v<m.value.length-1&&o("span",{class:"v-autocomplete__selection-comma"},[ze(",")])])])})]),"append-inner":function(){var x;for(var u=arguments.length,v=new Array(u),s=0;s<u;s++)v[s]=arguments[s];return o(L,null,[(x=t["append-inner"])==null?void 0:x.call(t,...v),l.menuIcon?o(ee,{class:"v-autocomplete__menu-icon",icon:l.menuIcon,onMousedown:de,onClick:He,"aria-label":B(W.value),title:B(W.value)},null):void 0])}})}),$e({isFocused:w,isPristine:C,menu:r,search:c,filteredItems:O,select:k},p)}});export{Ge as V};
//# sourceMappingURL=VAutocomplete-bb02d114.js.map
