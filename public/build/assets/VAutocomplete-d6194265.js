import{p as ge,bv as ye,bw as Ve,Z as be,bx as ke,by as Ce,g as we,d as xe,r as M,s as T,O,f as k,bz as Fe,$ as Se,bA as Ie,bB as Ae,bC as Pe,w as j,B as G,j as De,aR as J,i as n,ay as E,bD as _e,W as L,bE as Re,bF as X,bG as Me,b0 as Te,H as Z,bH as Le,aW as Ee,ax as Be,bI as Ue,aX as Ke,bJ as Ne}from"./app-e531f30a.js";function Oe(l,h,t){if(h==null)return l;if(Array.isArray(h))throw new Error("Multiple matches is not implemented");return typeof h=="number"&&~h?n(E,null,[n("span",{class:"v-autocomplete__unmask"},[l.substr(0,h)]),n("span",{class:"v-autocomplete__mask"},[l.substr(h,t)]),n("span",{class:"v-autocomplete__unmask"},[l.substr(h+t)])]):l}const He=ge({autoSelectFirst:{type:[Boolean,String]},search:String,...ye({filterKeys:["title"]}),...Ve(),...be(ke({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...Ce({transition:!1})},"VAutocomplete"),$e=we()({name:"VAutocomplete",props:He(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,h){let{slots:t}=h;const{t:q}=xe(),m=M(),b=T(!1),g=T(!0),I=M(!1),H=M(),B=O(l,"menu"),v=k({get:()=>B.value,set:e=>{var u;B.value&&!e&&((u=H.value)!=null&&u.Î¨openChildren)||(B.value=e)}}),o=T(-1),Q=k(()=>{var e;return(e=m.value)==null?void 0:e.color}),{items:A,transformIn:Y,transformOut:ee}=Fe(l),{textColorClasses:le,textColorStyles:te}=Se(Q),c=O(l,"search",""),p=O(l,"modelValue",[],e=>Y(e===null?[null]:Ne(e)),e=>{const u=ee(e);return l.multiple?u:u[0]??null}),F=Ie(),{filteredItems:P,getMatches:ae}=Ae(l,A,()=>g.value?"":c.value),y=k(()=>p.value.map(e=>A.value.find(u=>l.valueComparator(u.value,e.value))||e)),C=k(()=>l.hideSelected?P.value.filter(e=>!y.value.some(u=>u.value===e.value)):P.value),U=k(()=>y.value.map(e=>e.props.value)),z=k(()=>y.value[o.value]),D=k(()=>{var u;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&c.value===((u=C.value[0])==null?void 0:u.title))&&C.value.length>0&&!g.value&&!I.value}),K=k(()=>l.hideNoData&&!A.value.length||l.readonly||(F==null?void 0:F.isReadonly.value)),N=M(),{onListScroll:ue,onListKeydown:ne}=Pe(N,m);function oe(e){l.openOnClear&&(v.value=!0),c.value=""}function se(){K.value||(v.value=!0)}function ie(e){K.value||(b.value&&(e.preventDefault(),e.stopPropagation()),v.value=!v.value)}function ce(e){var V,a,r;if(l.readonly||F!=null&&F.isReadonly.value)return;const u=m.value.selectionStart,s=U.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(e.key))&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(v.value=!0),["Escape"].includes(e.key)&&(v.value=!1),["Enter","Escape","Tab"].includes(e.key)&&(D.value&&["Enter","Tab"].includes(e.key)&&w(P.value[0]),g.value=!0),e.key==="ArrowDown"&&D.value&&((V=N.value)==null||V.focus("next")),!!l.multiple){if(["Backspace","Delete"].includes(e.key)){if(o.value<0){e.key==="Backspace"&&!c.value&&(o.value=s-1);return}const i=o.value;z.value&&w(z.value),o.value=i>=s-1?s-2:i}if(e.key==="ArrowLeft"){if(o.value<0&&u>0)return;const i=o.value>-1?o.value-1:s-1;y.value[i]?o.value=i:(o.value=-1,m.value.setSelectionRange((a=c.value)==null?void 0:a.length,(r=c.value)==null?void 0:r.length))}if(e.key==="ArrowRight"){if(o.value<0)return;const i=o.value+1;y.value[i]?o.value=i:(o.value=-1,m.value.setSelectionRange(0,0))}}}function re(e){c.value=e.target.value}function ve(e){var u,s;if((u=m.value)!=null&&u.matches(":autofill")||(s=m.value)!=null&&s.matches(":-webkit-autofill")){const V=A.value.find(a=>a.title===e.target.value);V&&w(V)}}function de(){var e;b.value&&(g.value=!0,(e=m.value)==null||e.focus())}function fe(e){b.value=!0,setTimeout(()=>{I.value=!0})}function me(e){I.value=!1}function pe(e){(e==null||e===""&&!l.multiple)&&(p.value=[])}const S=T(!1);function w(e){if(l.multiple){const u=U.value.findIndex(s=>l.valueComparator(s,e.value));if(u===-1)p.value=[...p.value,e];else{const s=[...p.value];s.splice(u,1),p.value=s}}else p.value=[e],S.value=!0,c.value=e.title,v.value=!1,g.value=!0,G(()=>S.value=!1)}return j(b,(e,u)=>{var s;e!==u&&(e?(S.value=!0,c.value=l.multiple?"":String(((s=y.value.at(-1))==null?void 0:s.props.title)??""),g.value=!0,G(()=>S.value=!1)):(!l.multiple&&!c.value?p.value=[]:D.value&&!I.value&&!y.value.some(V=>{let{value:a}=V;return a===C.value[0].value})&&w(C.value[0]),v.value=!1,c.value="",o.value=-1))}),j(c,e=>{!b.value||S.value||(e&&(v.value=!0),g.value=!e)}),De(()=>{const e=!!(l.chips||t.chip),u=!!(!l.hideNoData||C.value.length||t["prepend-item"]||t["append-item"]||t["no-data"]),s=p.value.length>0,[V]=J.filterProps(l);return n(J,L({ref:m},V,{modelValue:c.value,"onUpdate:modelValue":pe,focused:b.value,"onUpdate:focused":a=>b.value=a,validationValue:p.externalValue,dirty:s,onInput:re,onChange:ve,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":v.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!t.selection,"v-autocomplete--selecting-index":o.value>-1},l.class],style:l.style,readonly:l.readonly,placeholder:s?void 0:l.placeholder,"onClick:clear":oe,"onMousedown:control":se,onKeydown:ce}),{...t,default:()=>n(E,null,[n(_e,L({ref:H,modelValue:v.value,"onUpdate:modelValue":a=>v.value=a,activator:"parent",contentClass:"v-autocomplete__content",disabled:K.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterLeave:de},l.menuProps),{default:()=>[u&&n(Re,{ref:N,selected:U.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:a=>a.preventDefault(),onKeydown:ne,onFocusin:fe,onFocusout:me,onScrollPassive:ue,tabindex:"-1"},{default:()=>{var a,r,i;return[(a=t["prepend-item"])==null?void 0:a.call(t),!C.value.length&&!l.hideNoData&&(((r=t["no-data"])==null?void 0:r.call(t))??n(X,{title:q(l.noDataText)},null)),n(Me,{renderless:!0,items:C.value},{default:x=>{var W;let{item:d,index:f,itemRef:he}=x;const $=L(d.props,{ref:he,key:f,active:D.value&&f===0?!0:void 0,onClick:()=>w(d)});return((W=t.item)==null?void 0:W.call(t,{item:d,index:f,props:$}))??n(X,$,{prepend:_=>{let{isSelected:R}=_;return n(E,null,[l.multiple&&!l.hideSelected?n(Te,{key:d.value,modelValue:R,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependIcon&&n(Z,{icon:d.props.prependIcon},null)])},title:()=>{var _,R;return g.value?d.title:Oe(d.title,(_=ae(d))==null?void 0:_.title,((R=c.value)==null?void 0:R.length)??0)}})}}),(i=t["append-item"])==null?void 0:i.call(t)]}})]}),y.value.map((a,r)=>{var d;function i(f){f.stopPropagation(),f.preventDefault(),w(a)}const x={"onClick:close":i,onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return n("div",{key:a.value,class:["v-autocomplete__selection",r===o.value&&["v-autocomplete__selection--selected",le.value]],style:r===o.value?te.value:{}},[e?t.chip?n(Ee,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:a.title}}},{default:()=>{var f;return[(f=t.chip)==null?void 0:f.call(t,{item:a,index:r,props:x})]}}):n(Le,L({key:"chip",closable:l.closableChips,size:"small",text:a.title},x),null):((d=t.selection)==null?void 0:d.call(t,{item:a,index:r}))??n("span",{class:"v-autocomplete__selection-text"},[a.title,l.multiple&&r<y.value.length-1&&n("span",{class:"v-autocomplete__selection-comma"},[Be(",")])])])})]),"append-inner":function(){var x;for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return n(E,null,[(x=t["append-inner"])==null?void 0:x.call(t,...r),l.menuIcon?n(Z,{class:"v-autocomplete__menu-icon",icon:l.menuIcon,onMousedown:ie,onClick:Ue},null):void 0])}})}),Ke({isFocused:b,isPristine:g,menu:v,search:c,filteredItems:P,select:w},m)}});export{$e as V};
//# sourceMappingURL=VAutocomplete-d6194265.js.map
