import{p as fe,bw as me,bx as pe,Z as he,by as ye,bz as ge,g as Ve,d as ke,r as M,s as R,O as N,f as g,bA as be,$ as we,bB as Ce,bC as Fe,w as j,B as G,j as xe,aR as W,i as n,ay as E,bD as Ie,W as T,bE as Ae,bF as X,b1 as Se,H as Y,bG as De,aX as Pe,ax as _e,bH as Me,aY as Re,bI as Te}from"./app-5e1842e2.js";function Ee(l,p,a){if(p==null)return l;if(Array.isArray(p))throw new Error("Multiple matches is not implemented");return typeof p=="number"&&~p?n(E,null,[n("span",{class:"v-autocomplete__unmask"},[l.substr(0,p)]),n("span",{class:"v-autocomplete__mask"},[l.substr(p,a)]),n("span",{class:"v-autocomplete__unmask"},[l.substr(p+a)])]):l}const Le=fe({autoSelectFirst:{type:[Boolean,String]},search:String,...me({filterKeys:["title"]}),...pe(),...he(ye({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...ge({transition:!1})},"VAutocomplete"),Ue=Ve()({name:"VAutocomplete",props:Le(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,p){let{slots:a}=p;const{t:Z}=ke(),V=M(),k=R(!1),h=R(!0),A=M(!1),O=M(),L=N(l,"menu"),d=g({get:()=>L.value,set:e=>{var t;L.value&&!e&&((t=O.value)!=null&&t.Î¨openChildren)||(L.value=e)}}),o=R(-1),q=g(()=>{var e;return(e=V.value)==null?void 0:e.color}),{items:B,transformIn:J,transformOut:Q}=be(l),{textColorClasses:ee,textColorStyles:le}=we(q),i=N(l,"search",""),m=N(l,"modelValue",[],e=>J(Te(e)),e=>{const t=Q(e);return l.multiple?t:t[0]??null}),w=Ce(),{filteredItems:S,getMatches:ae}=Fe(l,B,g(()=>h.value?void 0:i.value)),y=g(()=>m.value.map(e=>B.value.find(t=>l.valueComparator(t.value,e.value))||e)),b=g(()=>l.hideSelected?S.value.filter(e=>!y.value.some(t=>t.value===e.value)):S.value),U=g(()=>y.value.map(e=>e.props.value)),H=g(()=>y.value[o.value]),D=g(()=>{var t;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&i.value===((t=b.value[0])==null?void 0:t.title))&&b.value.length>0&&!h.value&&!A.value}),K=g(()=>l.hideNoData&&!B.value.length||l.readonly||(w==null?void 0:w.isReadonly.value)),z=M();function te(e){l.openOnClear&&(d.value=!0),i.value=""}function ue(){K.value||(d.value=!0)}function ne(e){K.value||(k.value&&(e.preventDefault(),e.stopPropagation()),d.value=!d.value)}function oe(e){var F,u,v;if(l.readonly||w!=null&&w.isReadonly.value)return;const t=V.value.selectionStart,c=U.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(e.key))&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(d.value=!0),["Escape"].includes(e.key)&&(d.value=!1),["Enter","Escape","Tab"].includes(e.key)&&(D.value&&["Enter","Tab"].includes(e.key)&&C(S.value[0]),h.value=!0),e.key==="ArrowDown"&&D.value&&((F=z.value)==null||F.focus("next")),!!l.multiple){if(["Backspace","Delete"].includes(e.key)){if(o.value<0){e.key==="Backspace"&&!i.value&&(o.value=c-1);return}const s=o.value;H.value&&C(H.value),o.value=s>=c-1?c-2:s}if(e.key==="ArrowLeft"){if(o.value<0&&t>0)return;const s=o.value>-1?o.value-1:c-1;y.value[s]?o.value=s:(o.value=-1,V.value.setSelectionRange((u=i.value)==null?void 0:u.length,(v=i.value)==null?void 0:v.length))}if(e.key==="ArrowRight"){if(o.value<0)return;const s=o.value+1;y.value[s]?o.value=s:(o.value=-1,V.value.setSelectionRange(0,0))}}}function se(e){var t;e.key==="Tab"&&((t=V.value)==null||t.focus())}function ie(e){i.value=e.target.value}function ce(){var e;k.value&&(h.value=!0,(e=V.value)==null||e.focus())}function re(e){k.value=!0,setTimeout(()=>{A.value=!0})}function ve(e){A.value=!1}function de(e){(e==null||e===""&&!l.multiple)&&(m.value=[])}const I=R(!1);function C(e){if(l.multiple){const t=U.value.findIndex(c=>l.valueComparator(c,e.value));if(t===-1)m.value=[...m.value,e];else{const c=[...m.value];c.splice(t,1),m.value=c}}else m.value=[e],I.value=!0,i.value=e.title,d.value=!1,h.value=!0,G(()=>I.value=!1)}return j(k,(e,t)=>{var c;e!==t&&(e?(I.value=!0,i.value=l.multiple?"":String(((c=y.value.at(-1))==null?void 0:c.props.title)??""),h.value=!0,G(()=>I.value=!1)):(!l.multiple&&!i.value?m.value=[]:D.value&&!A.value&&!y.value.some(F=>{let{value:u}=F;return u===b.value[0].value})&&C(b.value[0]),d.value=!1,i.value="",o.value=-1))}),j(i,e=>{!k.value||I.value||(e&&(d.value=!0),h.value=!e)}),xe(()=>{const e=!!(l.chips||a.chip),t=!!(!l.hideNoData||b.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),c=m.value.length>0,[F]=W.filterProps(l);return n(W,T({ref:V},F,{modelValue:i.value,"onUpdate:modelValue":de,focused:k.value,"onUpdate:focused":u=>k.value=u,validationValue:m.externalValue,dirty:c,onInput:ie,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":d.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!a.selection,"v-autocomplete--selecting-index":o.value>-1},l.class],style:l.style,readonly:l.readonly,placeholder:c?void 0:l.placeholder,"onClick:clear":te,"onMousedown:control":ue,onKeydown:oe}),{...a,default:()=>n(E,null,[n(Ie,T({ref:O,modelValue:d.value,"onUpdate:modelValue":u=>d.value=u,activator:"parent",contentClass:"v-autocomplete__content",disabled:K.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterLeave:ce},l.menuProps),{default:()=>[t&&n(Ae,{ref:z,selected:U.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:se,onFocusin:re,onFocusout:ve,tabindex:"-1"},{default:()=>{var u,v,s;return[(u=a["prepend-item"])==null?void 0:u.call(a),!b.value.length&&!l.hideNoData&&(((v=a["no-data"])==null?void 0:v.call(a))??n(X,{title:Z(l.noDataText)},null)),b.value.map((r,x)=>{var $;const f=T(r.props,{key:x,active:D.value&&x===0?!0:void 0,onClick:()=>C(r)});return(($=a.item)==null?void 0:$.call(a,{item:r,index:x,props:f}))??n(X,f,{prepend:P=>{let{isSelected:_}=P;return n(E,null,[l.multiple&&!l.hideSelected?n(Se,{key:r.value,modelValue:_,ripple:!1,tabindex:"-1"},null):void 0,r.props.prependIcon&&n(Y,{icon:r.props.prependIcon},null)])},title:()=>{var P,_;return h.value?r.title:Ee(r.title,(P=ae(r))==null?void 0:P.title,((_=i.value)==null?void 0:_.length)??0)}})}),(s=a["append-item"])==null?void 0:s.call(a)]}})]}),y.value.map((u,v)=>{var x;function s(f){f.stopPropagation(),f.preventDefault(),C(u)}const r={"onClick:close":s,onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return n("div",{key:u.value,class:["v-autocomplete__selection",v===o.value&&["v-autocomplete__selection--selected",ee.value]],style:v===o.value?le.value:{}},[e?a.chip?n(Pe,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:u.title}}},{default:()=>{var f;return[(f=a.chip)==null?void 0:f.call(a,{item:u,index:v,props:r})]}}):n(De,T({key:"chip",closable:l.closableChips,size:"small",text:u.title},r),null):((x=a.selection)==null?void 0:x.call(a,{item:u,index:v}))??n("span",{class:"v-autocomplete__selection-text"},[u.title,l.multiple&&v<y.value.length-1&&n("span",{class:"v-autocomplete__selection-comma"},[_e(",")])])])})]),"append-inner":function(){var r;for(var u=arguments.length,v=new Array(u),s=0;s<u;s++)v[s]=arguments[s];return n(E,null,[(r=a["append-inner"])==null?void 0:r.call(a,...v),l.menuIcon?n(Y,{class:"v-autocomplete__menu-icon",icon:l.menuIcon,onMousedown:ne,onClick:Me},null):void 0])}})}),Re({isFocused:k,isPristine:h,menu:d,search:i,filteredItems:S,select:C},V)}});export{Ue as V};
//# sourceMappingURL=VAutocomplete-8aa32e97.js.map
